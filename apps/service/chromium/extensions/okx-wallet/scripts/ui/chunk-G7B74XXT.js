import{b as _e}from"./chunk-YYUUDQVK.js";import{a as fe}from"./chunk-RJDGREGT.js";import{b as le,e as pe,f as ce}from"./chunk-HJB4XHU5.js";import{a as ie,b as ne,h as M}from"./chunk-QJFOLFSE.js";import{a as de}from"./chunk-E75DNWM4.js";import{a as me}from"./chunk-GOMM7VSE.js";import{c as Z,g as H,h as $,p as K}from"./chunk-LTMEFQRN.js";import{b as te,c as ae}from"./chunk-MSUJSPID.js";import{h as re,i as se}from"./chunk-TU5XNYNZ.js";import{a as oe}from"./chunk-MZFOYMI4.js";import{a as j,ga as Q,x as q,z as J}from"./chunk-WSXZYUQ4.js";import{q as i}from"./chunk-IRNZUYU4.js";import{o as ee}from"./chunk-AUURQ3HI.js";import{cc as Ye}from"./chunk-B32MCU7F.js";import{a as X}from"./chunk-VOLYN562.js";import{a as De}from"./chunk-VLKJDIZ5.js";import{c as A}from"./chunk-AIPMH74P.js";import{ic as R,jc as Ue,u as G,z as Be}from"./chunk-Q23SA7M6.js";import{H as b,o as y,q as x}from"./chunk-E44TZGUB.js";import{O as C,w as o}from"./chunk-364XNTHB.js";import{H as We,ca as f}from"./chunk-W7JONHX2.js";import{a as Ve}from"./chunk-O3LHCDGR.js";import{a as h}from"./chunk-PDSGFBX4.js";import{f as m,o as r,q as s}from"./chunk-FJHLV356.js";r();s();var e=m(h()),xe=m(Ye()),ve=m(De()),F=m(ee()),B=m(We());C();r();s();var v=m(h()),O=m(ee());r();s();r();s();var ze=()=>{};function Ge(){return[!1,ze]}var ue=Ge;var we=ue;r();s();C();var Re=()=>{try{ie({tg_platform:M()})}catch{}},ge=(a=!1)=>{try{ne({tg_platform:M(),button:a?"password":"cancel"})}catch{}},Ze=(a,t)=>{Re();let n=y.tip({infoType:y.Tip.INFO_TYPE.default,title:o("wallet_extension_tgsync_dialog_title_verification_fail"),children:o("wallet_extension_tgsync_dialog_desc_verification_fail"),confirmText:o("wallet_extension_tgsync_dialog_btn_use_password"),btnFull:!1,zIndex:40003,cancelText:o("commonall_text_btn_cancel"),onConfirm:async()=>{ge(!0),await Promise.resolve(a()),n.destroy()},onCancel:async()=>{ge(!1),await Promise.resolve(t?.()),n.destroy()}});return n},ye=Ze;var $e=a=>{let[t]=ae(te.passwordType),[n]=we(),[l,_]=(0,v.useState)(t),u=()=>{_(1)},E=(0,O.useMemoizedFn)(async(L=!0)=>{if(!n){await Promise.resolve(a?.());return}if(!L){await Promise.resolve(a?.());return}ye(u,a)}),T=(0,O.useMemoizedFn)(()=>{_(t)});return(0,v.useEffect)(()=>{_(t)},[t]),{currentPasswordType:l,isPasskeyNewUser:n,onVerifyPasskeyFailed:E,onResetPasswordType:T}},Te=$e;r();s();var S=m(h()),P=m(Ve());C();r();s();var Pe={forgetPasswordLink:"_forgetPasswordLink_l8eva_1"};var Ee=({className:a="",strong:t=!1,from:n="",replace:l,path:_})=>{let u=_??q;return S.default.createElement(X,{to:n?`${u}?from=${n}`:u,className:`${a} ${Pe.forgetPasswordLink}`,replace:l},S.default.createElement(i.Text,{size:i.SIZE.xs,type:i.TYPE.secondary,align:i.ALIGN.left,strong:t},o("wallet_footer_subtitle_forgot_password")))};Ee.propTypes={className:P.default.string,strong:P.default.bool,from:P.default.string,replace:P.default.bool};var ke=Ee;Ue();Be();r();s();var he=m(h());C();var Ce=({confirm:a,visible:t})=>he.default.createElement(y.Prompt,{visible:t,infoType:y.Prompt.INFO_TYPE.warn,title:o("wallet_extension_security_dialog_protect_seed_phrase"),confirmText:o("commonall_text_btn_ok_passive"),text:o("wallet_extension_security_dialog_no_leak"),onConfirm:a,hideCloseBtn:!0,alignBottom:!1,maskClosable:!1,confirmBtnProps:{type:f.TYPE.highlight,size:f.SIZE.lg}});r();s();r();s();var p={guard:"_guard_k59wc_1",title:"_title_k59wc_1",subTitle:"_subTitle_k59wc_6",inputPassword:"_inputPassword_k59wc_11",inputClass:"_inputClass_k59wc_15",guardInputClass:"_guardInputClass_k59wc_19",guardHeaderClass:"_guardHeaderClass_k59wc_22",forgot:"_forgot_k59wc_25",forgotInput:"_forgotInput_k59wc_29",unlockTrigger:"_unlockTrigger_k59wc_33"};var Ke=13,Pr=a=>{let t=(0,ve.useHistory)(),{current:{walletId:n,actionType:l,nextPath:_=j,groupId:u}}=e.default.useRef(de(t&&t.location.search.slice(1))),{callback:E,guard:T,onBack:L,path:U}=a,V=(0,e.useRef)(),w=(0,xe.useDispatch)(),[g,Le]=e.default.useState(),[W,Y]=e.default.useState(),[Ie,I]=(0,e.useState)(!1),[Ne,be]=(0,e.useState)(!1),{currentPasswordType:Ae,onVerifyPasskeyFailed:Me}=Te(),{handleCloudResetError:Oe}=fe(),k=Ae===2,Se=(0,F.useMemoizedFn)(({target:{value:c}})=>{Le(c),Y(void 0)},[]),D=c=>{if(I(!1),E){E(c);return}_&&t.replace(_)},N=(0,F.useMemoizedFn)(async()=>{try{if(I(!0),await K(V.current||g)===!0){if(T){be(!0);return}if(["removeLastWallet","removeWallet"].includes(l)?await w($(u)):l==="removeAccount"&&await w(H(n)),l==="removeLastWallet"){await w(Z()),await w(_e()),await w(re(1)),await w(se(void 0)),t.push(J);return}l==="removeAccount"?b.success(o("wallet_extension_delete_notification_account_deleted")):l==="removeWallet"&&b.success(o("wallet_editwallet_toast_delete_wallet_success")),D(g)}}catch(c){if(I(!1),Oe(c))return;Y(o("wallet_set_password_errortip_password_wrong"))}},[_,n,g,l]),{open:Fe}=ce(),z=(0,e.useMemo)(()=>{switch(U){case Q:return!0;default:return!1}},[U]);return e.default.createElement("div",{className:"verify_password_page__wrapper main-container",onKeyDown:c=>{c.keyCode===Ke&&N()}},e.default.createElement(me,{bordered:!1,closeable:["removeWallet"].includes(l),onBack:L}),e.default.createElement("div",{className:"verify-password-page"},z?e.default.createElement(e.default.Fragment,null,e.default.createElement(A.FlexBox,{className:p.guard,direction:A.DIRECTION.vertical},e.default.createElement(i.Text,{strong:700,className:p.title},o("wallet_extension_security_header_backup_seed_phrase")),e.default.createElement(i.Text,{type:i.TYPE.secondary,className:p.subTitle},o("wallet_extension_security_desc_seed_phrase_leak")))):e.default.createElement("h2",{className:(0,B.default)("verify-password-page__header",{[p.guardHeaderClass]:T})},o("wallet_extension_tgsync_current_password_verify")),e.default.createElement("div",{className:`verify-password-page__input ${(0,B.default)(p.inputClass,{[p.guardInputClass]:T})}`},k?e.default.createElement(le,{className:p.unlockTrigger,onPass:async c=>{V.current=c,await N()},onCancel:Me}):e.default.createElement(pe,{elementName:"v"},e.default.createElement(x.Password,{autoFocus:!0,value:g,autoComplete:"off",onChange:Se,placeholder:o("wallet_extension_tg_enter_password",{},{useBr:!1}),size:x.SIZE.xl,error:W,errorType:x.TIP_TYPE.always,inputClassName:"verify-password-page__input__core",label:z?o("wallet_set_password_maintitle_enter_password"):""}))),k&&R()!==G?e.default.createElement(i.Text,{className:p.forgot,align:i.ALIGN.center,size:i.SIZE.xs,type:i.TYPE.secondary,onClick:()=>{Fe()}},o("wallet_extension_biometrics_dialog_title_cant_unlock")):e.default.createElement(ke,{className:k?p.forgot:p.forgotInput}),e.default.createElement(oe.FooterActions,{usePortal:!0,renderNative:!0,buttonGroup:[{loading:Ie,onClick:N,size:f.SIZE.lg,visible:!k,type:f.TYPE.highlight,category:f.CATEGORY.fill,disabled:!g||g?.length<6||!!W,btnText:o("wallet_set_password_btn_confirm")}]}),e.default.createElement(Ce,{visible:Ne,confirm:D})))};export{we as a,Te as b,ke as c,Pr as d};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-G7B74XXT.js.map
