import{a as k}from"./chunk-5H6XZDRF.js";import{b as H}from"./chunk-TKZ7N5JX.js";import{c as y,o as u,p as g,q as m}from"./chunk-FJHLV356.js";var T=y(P=>{"use strict";u();m();Object.defineProperty(P,"__esModule",{value:!0});P.SignType=void 0;var U;(function(t){t[t.Secp256k1=1]="Secp256k1",t[t.ECDSA_P256=2]="ECDSA_P256",t[t.ED25519=3]="ED25519",t[t.StarknetSignType=4]="StarknetSignType",t[t.TezosSignType=5]="TezosSignType"})(U=P.SignType||(P.SignType={}))});var _=y(r=>{"use strict";u();m();Object.defineProperty(r,"__esModule",{value:!0});r.SignCommonMsgError=r.EstimateFeeError=r.validSignedTransactionError=r.GetPayLoadError=r.HardwareDerivePubKeyError=r.CalcTxHashError=r.SignMsgStep3Error=r.SignMsgSetupError=r.Ed25519Step3Error=r.Ed25519Step2Error=r.Ed25519Step1Error=r.Ed25519SetupError=r.EcdsaStep3Error=r.EcdsaStep2Error=r.EcdsaStep1Error=r.EcdsaSetupError=r.MPCShakeHandsError=r.MPCStepError=r.MPCAesKeyMissError=r.GetHardWareMessageHashError=r.GetHardwareSignedTransactionError=r.GetHardwareRawTransactionError=r.GetMpcTransactionError=r.GetMpcRawTransactionError=r.DerivePathError=r.GenMnemonicError=r.GenPrivateKeyError=r.UnsupportedCoinError=r.SignMsgError=r.SignTxError=r.ValidAddressError=r.NewAddressError=r.NotImplementedError=void 0;r.NotImplementedError="no implementation method";r.NewAddressError="generate address error";r.ValidAddressError="valid address error";r.SignTxError="sign tx error";r.SignMsgError="sign message error";r.UnsupportedCoinError="unsupported currency";r.GenPrivateKeyError="generate private key error";r.GenMnemonicError="generate mnemonic error";r.DerivePathError="derive hdPath error";r.GetMpcRawTransactionError="get mpc raw transaction error";r.GetMpcTransactionError="get mpc transaction error";r.GetHardwareRawTransactionError="get hardware raw transaction error";r.GetHardwareSignedTransactionError="get hardware signed transaction error";r.GetHardWareMessageHashError="get hardware message hash error";r.MPCAesKeyMissError="mpc get aes key error";r.MPCStepError="mpc step error";r.MPCShakeHandsError="mpc shake hands error";r.EcdsaSetupError="ecdsa setup error";r.EcdsaStep1Error="ecdsa step1 error";r.EcdsaStep2Error="ecdsa step2 error";r.EcdsaStep3Error="ecdsa step3 error";r.Ed25519SetupError="ed25519 setup error";r.Ed25519Step1Error="ed25519 step1 error";r.Ed25519Step2Error="ed25519 step2 error";r.Ed25519Step3Error="ed25519 step3 error";r.SignMsgSetupError="sign message setup error";r.SignMsgStep3Error="sign message step3 error";r.CalcTxHashError="calculate tx hash error";r.HardwareDerivePubKeyError="derive sub pub key error";r.GetPayLoadError="get payload error";r.validSignedTransactionError="valid signed transaction error";r.EstimateFeeError="estimate fee error";r.SignCommonMsgError="sign common msg error"});var x=y(d=>{"use strict";u();m();Object.defineProperty(d,"__esModule",{value:!0});d.jsonStringifyUniform=d.cloneObject=d.assertBufferLength=d.convert2BigNumber=d.convert2Number=d.buildCommonSignMsg=void 0;var h=H();function D(t,e){return`OKX Wallet Sign In

publicKey: ${t}
walletId: ${e}
host: api.wallet.okx
OKX Wallet Sign In`}d.buildCommonSignMsg=D;function R(t){if(t!=null)return typeof t=="string"?parseInt(t):t}d.convert2Number=R;function W(t){if(t!=null)return h.BigNumber.isBigNumber(t)?t:new h.BigNumber(t)}d.convert2BigNumber=W;function q(t,e){if(t.length!=e)throw Error("buffer length is illegal")}d.assertBufferLength=q;function $(t){return JSON.parse(JSON.stringify(t))}d.cloneObject=$;function F(t){return JSON.stringify(t,(e,n)=>n&&(n.type==="Buffer"||n instanceof Uint8Array?h.base.toHex(n):typeof n=="bigint"?n.toString():n))}d.jsonStringifyUniform=F});var j=y(S=>{"use strict";u();m();var z=S&&S.__createBinding||(Object.create?function(t,e,n,o){o===void 0&&(o=n);var i=Object.getOwnPropertyDescriptor(e,n);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,o,i)}:function(t,e,n,o){o===void 0&&(o=n),t[o]=e[n]}),J=S&&S.__exportStar||function(t,e){for(var n in t)n!=="default"&&!Object.prototype.hasOwnProperty.call(e,n)&&z(e,t,n)};Object.defineProperty(S,"__esModule",{value:!0});J(x(),S)});var A=y(s=>{"use strict";u();m();Object.defineProperty(s,"__esModule",{value:!0});s.SimpleWallet=s.BaseWallet=s.ecdsaSign=s.fromSigned=s.padWithZeroes=s.toUnsigned=s.intToHex=s.makeSignature=s.secp256k1SignTest=void 0;var a=_(),v=T(),c=H(),L=j();function C(t){let e=c.base.sha256("secp256k1-test"),n=c.signUtil.secp256k1.publicKeyCreate(t,!1),{signature:o,recovery:i}=c.signUtil.secp256k1.sign(g.Buffer.from(e),t);return c.signUtil.secp256k1.verify(e,o,i,n)}s.secp256k1SignTest=C;function O(t,e,n){let o=(0,s.fromSigned)(e),i=(0,s.fromSigned)(n),f=t,E=N((0,s.toUnsigned)(o).toString("hex"),64),p=N((0,s.toUnsigned)(i).toString("hex"),64);return c.base.stripHexPrefix(I(f)).concat(E,p)}s.makeSignature=O;function I(t){return`0x${t.toString(16)}`}s.intToHex=I;var X=function(t){return g.Buffer.from(t.toTwos(256).toArray())};s.toUnsigned=X;function N(t,e){if(t!==""&&!/^[a-f0-9]+$/iu.test(t))throw new Error(`Expected an unprefixed hex string. Received: ${t}`);if(e<0)throw new Error(`Expected a non-negative integer target length. Received: ${e}`);return String.prototype.padStart.call(t,e,"0")}s.padWithZeroes=N;var Z=function(t){return new c.BN(t).fromTwos(256)};s.fromSigned=Z;function G(t,e,n){let{signature:o,recovery:i}=c.signUtil.secp256k1.sign(t,e),f=g.Buffer.from(o.slice(0,32)),E=g.Buffer.from(o.slice(32,64));if(n&&!Number.isSafeInteger(n))throw new Error("The provided number is greater than MAX_SAFE_INTEGER (please use an alternative input type)");return{v:n?i+(n*2+35):i+27,r:f,s:E}}s.ecdsaSign=G;var w=class{getRandomPrivateKey(){try{for(;;){let e=c.base.randomBytes(32);if(C(e))return Promise.resolve(c.base.toHex(e,!0))}}catch{}return Promise.reject(a.GenPrivateKeyError)}getDerivedPrivateKey(e){return c.bip39.mnemonicToSeed(e.mnemonic).then(n=>{let o=c.bip32.fromSeed(n).derivePath(e.hdPath);if(o.privateKey){let i=c.base.toHex(o.privateKey);return Promise.resolve("0x"+i)}else return Promise.reject(a.GenPrivateKeyError)}).catch(n=>Promise.reject(a.GenPrivateKeyError))}getDerivedPath(e){return Promise.reject(a.NotImplementedError)}validPrivateKey(e){return Promise.reject(a.NotImplementedError)}signMessage(e){return Promise.reject(a.NotImplementedError)}async signCommonMsg(e){e.signType||(e.signType=v.SignType.Secp256k1);let n;if(e.message.text)n=e.message.text;else{let p;if(e.publicKey?p=e.publicKey:p=(await this.getNewAddress({privateKey:e.privateKey,addressType:e.addressType,hrp:e.hrp,version:e.version})).publicKey,p.startsWith("0x")&&(p=p.substring(2)),!e.message.walletId)return Promise.reject("invalid walletId");n=(0,L.buildCommonSignMsg)(p,e.message.walletId)}let o=c.base.magicHash(n),i=e.privateKeyHex?e.privateKeyHex:e.privateKey,f=c.base.fromHex(i);var E;switch(e.signType){case v.SignType.Secp256k1:let{v:p,r:M,s:B}=G(g.Buffer.from(o),f);return Promise.resolve(O(p,M,B));case v.SignType.ECDSA_P256:return E=c.signUtil.p256.sign(g.Buffer.from(o),f).signature,Promise.resolve(c.base.toHex(E));case v.SignType.ED25519:return E=c.signUtil.ed25519.sign(o,f),Promise.resolve(c.base.toHex(E));case v.SignType.StarknetSignType:return E=c.signUtil.schnorr.stark.sign(o,f).toCompactRawBytes(),Promise.resolve(c.base.toHex(E));case v.SignType.TezosSignType:return Promise.reject("not support")}}verifyMessage(e){return Promise.reject(a.NotImplementedError)}ecRecover(e,n){return Promise.reject(a.NotImplementedError)}getAddressByPublicKey(e){return Promise.reject(a.NotImplementedError)}getMPCRawTransaction(e){return Promise.reject(a.NotImplementedError)}getMPCTransaction(e){return Promise.reject(a.NotImplementedError)}getMPCRawMessage(e){return Promise.reject(a.NotImplementedError)}getMPCSignedMessage(e){return Promise.reject(a.NotImplementedError)}getHardWareRawTransaction(e){return Promise.reject(a.NotImplementedError)}getHardWareSignedTransaction(e){return Promise.reject(a.NotImplementedError)}getHardWareMessageHash(e){return Promise.reject(a.NotImplementedError)}calcTxHash(e){return Promise.reject(a.NotImplementedError)}getRawTransaction(e){return Promise.reject(a.NotImplementedError)}validSignedTransaction(e){return Promise.reject(a.NotImplementedError)}estimateFee(e){return Promise.reject(a.NotImplementedError)}};s.BaseWallet=w;var K=class extends w{mockData(e,n){this.mockAddress=e,this.mockPublicKey=n}getNewAddress(e){return Promise.resolve({address:this.mockAddress,publicKey:this.mockPublicKey})}validAddress(e){throw new Error("Method not implemented.")}signTransaction(e){throw new Error("Method not implemented.")}};s.SimpleWallet=K});var Q=y(l=>{"use strict";u();m();var V=l&&l.__createBinding||(Object.create?function(t,e,n,o){o===void 0&&(o=n);var i=Object.getOwnPropertyDescriptor(e,n);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,o,i)}:function(t,e,n,o){o===void 0&&(o=n),t[o]=e[n]}),b=l&&l.__exportStar||function(t,e){for(var n in t)n!=="default"&&!Object.prototype.hasOwnProperty.call(e,n)&&V(e,t,n)};Object.defineProperty(l,"__esModule",{value:!0});b(T(),l);b(k(),l);b(_(),l);b(A(),l);b(j(),l)});export{Q as a};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-EBWM3MRI.js.map
