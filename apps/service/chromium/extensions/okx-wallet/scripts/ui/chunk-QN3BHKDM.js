import{a as xe,b as be,c as Ee}from"./chunk-FGVAAF7J.js";import{c as M}from"./chunk-52ESRIYZ.js";import{a as z}from"./chunk-7YQLUBDN.js";import{a as pe}from"./chunk-2LNDMD6C.js";import{a as we}from"./chunk-KOPPPKVA.js";import{a as ge}from"./chunk-MZFOYMI4.js";import{o as W}from"./chunk-AUURQ3HI.js";import{wa as _e,za as Ze}from"./chunk-N4B7HQY5.js";import{Ac as Me,Bc as fe,Cc as Fe,Ka as ce,_a as Ve,kb as me,vc as ue,yb as Ye}from"./chunk-Q23SA7M6.js";import{G as P,o as O,q as N}from"./chunk-E44TZGUB.js";import{aa as de,f as H,j as ne,ja as le,o as ie,oa as Y}from"./chunk-KBQXBPIW.js";import{O as L,w as o}from"./chunk-364XNTHB.js";import{b as Pe}from"./chunk-NBWNTERD.js";import{H as ze,Z as K,ca as k}from"./chunk-W7JONHX2.js";import{a as Oe}from"./chunk-O3LHCDGR.js";import{a as C}from"./chunk-PDSGFBX4.js";import{f as x,o as m,q as u}from"./chunk-FJHLV356.js";m();u();var g=x(C());Y();L();m();u();var E=x(C());var ke=x(W());L();function X({type:s,addressData:r,addressInputValue:e,addressInputError:n,setAddressInputValue:d,setAddressInputError:p,onChangeToEdit:w,validNetworks:_,isLoading:t,isBetterLoading:i}){let{id:l,address:a}=r,c=s===A.TYPE.EDIT,f=M(e),b=!!f?.id&&(!c||f?.id!==l),I=(0,E.useRef)(!1),D=n&&I.current?n:"",{run:j}=(0,ke.useDebounceFn)(async()=>{let T="";e&&_&&!_.length&&(T=o("wallet_extension_addaddress_errortip_wrong_address")),b&&(T=o("wallet_extension_addaddress_errortip_address_exists")),I.current=!0,p(T)},{wait:50}),V=T=>{d(T.target.value)},S=()=>{w(f)};return(0,E.useEffect)(()=>{j()},[_]),E.default.createElement(E.default.Fragment,null,E.default.createElement(N.TextArea,{className:"address-edit-dialog__address-input",placeholder:o("wallet_extension_addaddress_input_enter_address"),disabled:!c&&a,label:o("wallet_extension_addaddress_subtitle_address"),value:e,error:!t&&!!D,errorType:N.TIP_TYPE.always,size:N.SIZE.xl,suffix:i&&E.default.createElement(K.Circle,{size:K.SIZE.sm}),onChange:V,autoResize:!0}),D&&E.default.createElement("div",{className:"address-edit-dialog__address-input__error"},D,b&&E.default.createElement("span",{className:"address-edit-dialog__address-input__error-action",onClick:S},o("wallet_extension_addaddress_anchor_go_to_edit"))))}m();u();var he=x(C());L();Ze();function U({type:s,addressId:r,nameInputValue:e,addressInputValue:n,networkSelectList:d,addressInputError:p,nameInputError:w,hasSelect:_,onClose:t}){let i=s===A.TYPE.EDIT,l=e===""||n===""||p!==""||w!==""||!_||d.length===0,a=async c=>{c.stopPropagation();let f={address:n,name:e,networks:d};if(i)await be(r,f),P.success({title:o("wallet_extension_editaddress_toast_edit_saved")}),t(f);else try{await xe(f),P.success({title:o("wallet_extension_addressbook_toast_address_added")}),t(f)}catch(b){b?.message===_e&&P.error({title:o("wallet_extension_addressbook_toast_address_limit_reached")})}};return he.default.createElement(k,{className:"address-edit-dialog__save",disabled:l,category:k.CATEGORY.fill,type:k.TYPE.highlight,size:k.SIZE.lg,onClick:a,block:!0},o("wallet_set_password_btn_confirm"))}m();u();var ve=x(C());L();function J({addressId:s,onClose:r,onDelete:e}){let n=()=>{let p=O.warn({title:o("wallet_extension_editaddress_modal_detele_address"),alignBottom:!1,cancelText:o("wallet_extension_editaddress_btn_cancel"),confirmText:o("wallet_extension_editaddress_btn_detele"),onCancel:()=>{p.destroy()},onConfirm:async()=>{await Ee(s),P.success({title:o("wallet_extension_addressbook_toast_address_deleted")}),e&&e(),r()}})},d=()=>{n()};return ve.default.createElement(k,{className:"address-edit-dialog__delete-button",contentClassName:"address-edit-dialog__delete-button-content",category:k.CATEGORY.outline,type:k.TYPE.primary,size:k.SIZE.lg,onClick:d},o("commonall_resultpage_btn_delete"))}m();u();var B=x(C());L();var Ie=x(W());Y();function Q({nameInputValue:s,nameInputError:r,setNameInputValue:e,setNameInputError:n}){let d=(0,B.useRef)(),p=(0,B.useRef)(!1),w=r&&p.current?r:"",{run:_}=(0,Ie.useDebounceFn)(()=>{p.current=!0;let i="";de(s)>20&&(i=o("wallet_extension_addaddress_errortip_maximum_20")),n(i)},{wait:50}),t=i=>{_(),e(i.target.value)};return(0,B.useEffect)(()=>{d.current.focus()},[]),B.default.createElement(N,{className:"address-edit-dialog__name-input",placeholder:o("wallet_extension_addaddress_input_enter_name_limit"),label:o("wallet_extension_addaddress_subtitle_name"),value:s,error:w,errorType:N.TIP_TYPE.always,size:N.SIZE.xl,onChange:t,maxLength:30,onRef:i=>{d.current=i}})}m();u();var y=x(C());Y();L();m();u();var v=x(C()),F=x(Oe()),$=x(ze());Y();m();u();var R=({className:s="",options:r=[],onChange:e=()=>{}})=>{let[n,d]=(0,v.useState)({}),[p,w]=(0,v.useState)({});(0,v.useEffect)(()=>{let t={},i={};for(let l=0;l<r.length;l++){let a=r[l];a.active&&(t[a.value]=a),a.disabled&&(i[a.value]=a)}d(t),w(i)},[r]);let _=t=>{if(t.disabled)return;let i=t.value,l=ie(n);n[i]?(delete l[i],d(l)):(l[i]=t,d(l));let a=Object.values(l);e&&e(a)};return v.default.createElement("div",{className:(0,$.default)("ok-button-checkbox",s)},r.map((t,i)=>v.default.createElement("div",{className:(0,$.default)("ok-button-checkbox__item",{"ok-button-checkbox__item--active":!!n[t.value],"ok-button-checkbox__item--disabled":!!p[t.value]}),onClick:()=>{_(t)},key:i},t.image&&v.default.createElement("img",{className:"ok-button-checkbox__item-icon",src:t.image,alt:t.label}),v.default.createElement("span",{className:"ok-button-checkbox__item-text"},t.label))))};R.propTypes={className:F.default.string,options:F.default.array,onChange:F.default.func};R.defaultProps={className:"",options:[],onChange:()=>{}};var Ce=R;Ye();var Ge=[me];function ee({network:s,networkSelectList:r,setNetworkSelectList:e,setHasSelect:n,disabled:d,validNetworks:p}){let w=we(),[_,t]=(0,y.useState)([]),i=a=>{if(!a.length){e([]);return}let c=a.map(f=>f.value);e(c)},l=z();return(0,y.useLayoutEffect)(()=>{let a=l.filter(({coinType:c,localType:f})=>!Ge.includes(f)&&p?.includes(c)).map(({chainName:c,localType:f})=>{let b=ne(w.find(I=>I.localType===f),"image");return{disabled:s===f,active:r.includes(f),label:c,value:f,image:b}});t(a),n(a.some(c=>c.active))},[p,r,l]),d||!_.length?null:y.default.createElement("div",{className:"address-edit-dialog__network-select"},y.default.createElement("div",{className:"address-edit-dialog__network-select__title"},o("wallet_extension_addressbook_title_select_networks")),y.default.createElement(Ce,{options:_,onChange:i}))}m();u();var G=x(C());m();u();Pe();var Z=x(C()),Ne=x(W());Y();Me();Fe();Ve();var Ae={[14001]:async s=>{if(!s)return!1;let r={account:s,coinId:ce},e;try{e=await ue(fe.queryAccountExist,r)}catch{H()}return!!e?.data?.account},default:async(s,r,e)=>{let{validAddress:n}=await pe(),{isValid:d}=await n(r.valueOf(),{address:s,hrp:e});return d}};function je(){let[s,r]=(0,Z.useState)(0),e=(0,Z.useRef)(0),n=z(),d=s>0,p=(0,Ne.useDebounce)(d,{wait:200});return{isLoading:d,isBetterLoading:p,validAddress:(_,t)=>{(async()=>{let l=++e.current,a=[];r(c=>c+1);try{await Promise.all(n.map(async({coinType:c,cosmosPrefix:f})=>{try{await(Ae[c]||Ae.default)(_,c,f)&&a.push(Number(c))}catch{H()}}))}finally{l===e.current&&(r(0),t(a))}})()}}}var ye=je;function qe(s){let[r,e]=(0,G.useState)(null),{isLoading:n,isBetterLoading:d,validAddress:p}=ye();return(0,G.useEffect)(()=>{if(!s){e(null);return}p(s,w=>{e(w)})},[s]),{validNetworks:r,isBetterLoading:d,isLoading:n}}var Te=qe;m();u();function A({type:s,data:r,onClose:e,visible:n,onDelete:d,onChangeToEdit:p}){let{id:w,address:_,network:t}=r,i=M(_),[l,a]=(0,g.useState)(""),[c,f]=(0,g.useState)(""),[b,I]=(0,g.useState)(""),[D,j]=(0,g.useState)(""),[V,S]=(0,g.useState)([]),[T,Be]=(0,g.useState)(!0),{isLoading:De,isBetterLoading:te,validNetworks:se}=Te(l);(0,g.useEffect)(()=>{if(s===A.TYPE.EDIT&&i){let{name:q,networks:re}=i,ae=re;t&&(ae=le([...re,t])),I(q),a(_),S(ae)}else a(_||""),S(t?[t]:[]),I("")},[s,_,t,n]);let oe=s===A.TYPE.EDIT,Se=l||b||V.length,Le=oe?o("wallet_extension_editaddress_title_edit_address"):o("wallet_extension_addaddress_title_add_address");return g.default.createElement(O.Action,{isFull:!0,visible:n,title:Le,containerClassName:"edit-address-container",scrollBoxClassName:"edit-address-scroll-box",onClose:()=>{if(!oe&&Se){let q=O.warn({maskClassName:"edit-address-confirm-dialog",title:o("wallet_extension_addaddress_modal_cancel_adding"),alignBottom:!1,cancelText:o("wallet_extension_addaddress_btn_no"),confirmText:o("wallet_extension_addaddress_btn_yes"),onCancel:()=>{q.destroy()},onConfirm:async()=>{e()}})}else e()}},g.default.createElement("div",{className:"address-edit-dialog"},g.default.createElement("div",{className:"address-edit-dialog__body"},g.default.createElement(Q,{nameInputValue:b,nameInputError:D,setNameInputValue:I,setNameInputError:j}),g.default.createElement(X,{type:s,addressData:r,addressInputValue:l,addressInputError:c,setAddressInputError:f,setAddressInputValue:a,onChangeToEdit:p,validNetworks:se,isLoading:De,isBetterLoading:te}),g.default.createElement(ee,{network:t,networkSelectList:V,setNetworkSelectList:S,setHasSelect:Be,validNetworks:se,disabled:!l||c||te})),g.default.createElement(ge.FooterActions,{placeholder:!1,affixStyle:{position:"static",width:"100%"}},s===A.TYPE.EDIT&&g.default.createElement(J,{addressId:w,onClose:e,onDelete:d}),g.default.createElement(U,{type:s,addressId:w,nameInputValue:b,addressInputValue:l,networkSelectList:V,addressInputError:c,nameInputError:D,hasSelect:T,onClose:e}))))}A.TYPE={EDIT:"edit",ADD:"add"};export{A as a};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-QN3BHKDM.js.map
