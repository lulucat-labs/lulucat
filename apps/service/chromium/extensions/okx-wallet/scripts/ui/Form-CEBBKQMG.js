import{a as Me}from"./chunk-I6VIV2LW.js";import{a as Re}from"./chunk-2P7I7CKT.js";import{a as We,c as W,d as D}from"./chunk-4L5OPDYI.js";import{b as ge,c as H,d as z,e as ve,f as ye,g as xe,h as Ie,i as be,j as Ne,k as Ee,l as U,m as O,n as j,o as ke,p as G,q as K,r as Ce,s as Te,t as Se,u as Ue}from"./chunk-DGEWW2LM.js";import{A as Be}from"./chunk-GCAD5G3O.js";import{a as Ae}from"./chunk-PS6ETN2V.js";import"./chunk-AZYPLE5D.js";import"./chunk-SULFXTUN.js";import"./chunk-OGS4HURJ.js";import"./chunk-HZNY4MK4.js";import"./chunk-6CI55CTV.js";import{b as ie}from"./chunk-ZZLPMRQY.js";import"./chunk-4HGOSSS7.js";import"./chunk-OIXVONQI.js";import"./chunk-REMRMZNH.js";import"./chunk-74FNJDB7.js";import{a as ze}from"./chunk-GOMM7VSE.js";import"./chunk-MSUJSPID.js";import"./chunk-TU5XNYNZ.js";import{a as $e}from"./chunk-MZFOYMI4.js";import"./chunk-EQ275TZX.js";import{R as he,a as ue,ya as we}from"./chunk-WSXZYUQ4.js";import{b as ne}from"./chunk-JRZXGORL.js";import"./chunk-IRNZUYU4.js";import"./chunk-SFTZ55EP.js";import"./chunk-DZHQUYHS.js";import{o as Le}from"./chunk-AUURQ3HI.js";import{cc as A}from"./chunk-B32MCU7F.js";import"./chunk-VOLYN562.js";import{a as Pe}from"./chunk-VLKJDIZ5.js";import"./chunk-N4B7HQY5.js";import"./chunk-TKFT6XV3.js";import"./chunk-MBLN6WQR.js";import{b as V}from"./chunk-XRF6BZHR.js";import{i as De}from"./chunk-OWU5GWTN.js";import"./chunk-2BGRD7AD.js";import"./chunk-TCJNKUJ2.js";import"./chunk-2UKLMOTV.js";import"./chunk-ZWQEMYA4.js";import"./chunk-ELX2GHLL.js";import"./chunk-AIPMH74P.js";import"./chunk-DJDG7W5Q.js";import{Ac as de,Bc as _e,Cc as lr,qb as me,vc as ce,xc as fe,yb as sr}from"./chunk-Q23SA7M6.js";import"./chunk-XXICVAVV.js";import{A as oe,c as te,q as y}from"./chunk-E44TZGUB.js";import"./chunk-KBQXBPIW.js";import{O as $,w as t}from"./chunk-364XNTHB.js";import"./chunk-NBWNTERD.js";import"./chunk-GBTEQNFM.js";import"./chunk-QBHNZ2BL.js";import"./chunk-J6E3F25X.js";import{H as ar,T as pe,Z as C,ca as T}from"./chunk-W7JONHX2.js";import"./chunk-O3LHCDGR.js";import{a as L}from"./chunk-PDSGFBX4.js";import"./chunk-GAMT4PKF.js";import"./chunk-R4QAJG6J.js";import"./chunk-LI7MZD2P.js";import"./chunk-WTNDHHRR.js";import"./chunk-CGP26AOO.js";import"./chunk-3MCJH4Z7.js";import"./chunk-AGN4QMRN.js";import"./chunk-3SRT54EN.js";import"./chunk-J5P7OMUC.js";import"./chunk-3CPUV3E7.js";import"./chunk-SHMKQUVK.js";import{c as nr,f as v,o as h,p as N,q as w}from"./chunk-FJHLV356.js";var se=nr((hr,qe)=>{h();w();(function(o){"use strict";o.exports.is_uri=f,o.exports.is_http_uri=r,o.exports.is_https_uri=i,o.exports.is_web_uri=u,o.exports.isUri=f,o.exports.isHttpUri=r,o.exports.isHttpsUri=i,o.exports.isWebUri=u;var s=function(a){var e=a.match(/(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/);return e};function f(a){if(!!a&&!/[^a-z0-9\:\/\?\#\[\]\@\!\$\&\'\(\)\*\+\,\;\=\.\-\_\~\%]/i.test(a)&&!/%[^0-9a-f]/i.test(a)&&!/%[0-9a-f](:?[^0-9a-f]|$)/i.test(a)){var e=[],n="",_="",m="",d="",p="",c="";if(e=s(a),n=e[1],_=e[2],m=e[3],d=e[4],p=e[5],!!(n&&n.length&&m.length>=0)){if(_&&_.length){if(!(m.length===0||/^\//.test(m)))return}else if(/^\/\//.test(m))return;if(!!/^[a-z][a-z0-9\+\-\.]*$/.test(n.toLowerCase()))return c+=n+":",_&&_.length&&(c+="//"+_),c+=m,d&&d.length&&(c+="?"+d),p&&p.length&&(c+="#"+p),c}}}function r(a,e){if(!!f(a)){var n=[],_="",m="",d="",p="",c="",I="",l="";if(n=s(a),_=n[1],m=n[2],d=n[3],c=n[4],I=n[5],!!_){if(e){if(_.toLowerCase()!="https")return}else if(_.toLowerCase()!="http")return;if(!!m)return/:(\d+)$/.test(m)&&(p=m.match(/:(\d+)$/)[0],m=m.replace(/:\d+$/,"")),l+=_+":",l+="//"+m,p&&(l+=p),l+=d,c&&c.length&&(l+="?"+c),I&&I.length&&(l+="#"+I),l}}}function i(a){return r(a,!0)}function u(a){return r(a)||i(a)}})(qe)});h();w();var g=v(L()),er=v(A()),rr=v(Pe()),tr=v(Le()),or=v(ar());$();h();w();var M=v(L()),Q=v(A());$();var Ze=(0,M.memo)(o=>{let{disabled:s}=o,f=(0,Q.useDispatch)(),r=({target:{value:n}})=>{f(be(n))},{name:i,nameErr:u}=(0,Q.useSelector)(ge),a=()=>{f(Ne(t(i?"":"developer_mode_network_errortip_cannotspace")))},e=t("extension_wallet_addnetwork_placeholder_network");return M.default.createElement("div",{className:"net-form__wrap-input"},M.default.createElement(y,{value:i,onBlur:a,disabled:s,size:y.SIZE.xl,errorType:y.TIP_TYPE.always,error:u,onChange:r,placeholder:e,label:t("wallet_transaction_history_subtitle_network_name")}))});h();w();var B=v(L()),Z=v(A()),Ye=v(se());$();h();w();h();w();de();async function Fe(o,s,f=[]){let r=o,i={"Content-Type":"application/json"},{origin:u,pathname:a,username:e,password:n,search:_}=new URL(o);if(e&&n){let I=N.Buffer.from(`${e}:${n}`).toString("base64");i.Authorization=`Basic ${I}`,r=`${u}${a}${_}`}let m=await fe(r,{id:Date.now().toString(),jsonrpc:"2.0",method:s,params:f},{timeout:3e4,cache:"default",headers:i}),d=m?.data;try{d||(d=await m.clone().json())}catch{}if(!d||Array.isArray(d)||typeof d!="object")throw new Error(`RPC endpoint ${o} returned non-object response.`);let{error:p,result:c}=d;if(p)throw new Error(p?.message||p);return c}var X=o=>{try{let s=new URL(o);return s.protocol==="http:"||s.protocol==="https:"}catch{return!1}},J=((o={})=>s=>new Promise((f,r)=>o[s]?f(o[s]):Fe(s,"eth_chainId").then(i=>{o[s]=i,f(i)}).catch(i=>{r(i)})))();var He=B.default.memo(o=>{let{disabled:s,modify:f}=o,r=(0,Z.useDispatch)(),[i,u]=(0,B.useState)(!1),a=({target:{value:c}})=>{r(Ee(c.trim()))},{rpcUrl:e,rpcUrlErr:n}=(0,Z.useSelector)(H),{rpcNetworks:_}=D(),{chainId:m}=(0,Z.useSelector)(z),d=()=>{if(!e)return r(U(t("developer_mode_network_errortip_cannotspace")));if(!X(e))return r(U(t("developer_mode_infor_errortip_https")));if(!Ye.default.isWebUri(e))return r(U(t("developer_mode_infor_errortip_rpcurl")));let I=_.find(l=>l.rpcUrl===e);return I&&!f?r(U(t("developer_mode_infor_errortip_used_network",{network:I.name}))):(u(!0),J(e).then(l=>{try{if(l=parseInt(l,16).toString(10),Number.isNaN(+l)){u(!1),r(U(""));return}f?l!==m&&r(j({err:t("developer_mode_infor_errortip_chainid",{chainID:l}),validChainId:m})):r(O(l))}catch{}u(!1),r(U(""))}).catch(()=>{r(U(t("developer_mode_infor_errortip_rpcurl"))),u(!1)}))},p=t("extension_wallet_addnetwork_placeholder_prcurl");return B.default.createElement("div",{className:"net-form__wrap-input"},B.default.createElement(y,{value:e,onBlur:d,disabled:s,size:y.SIZE.xl,errorType:y.TIP_TYPE.always,error:n,onChange:a,placeholder:p,label:t("developer_mode_network_title_rpcurl"),suffix:i&&B.default.createElement(C.Circle,{size:C.SIZE.sm})}))});h();w();var P=v(L()),q=v(A()),Oe=v(Le());$();lr();de();var mr=async o=>{let{data:s}=await ce(_e.getRpcNetworkByChainId,{chainIds:[o]});return s?.[0]?.nativeCurrency?.symbol},je=P.default.memo(o=>{let{disabled:s,modify:f}=o,r=(0,q.useDispatch)(),i=({target:{value:l}})=>{r(G(l.trim()))},{symbol:u,symbolErr:a,symbolTip:e}=(0,q.useSelector)(ve),[n,_]=(0,P.useState)(!1),{chainId:m}=(0,q.useSelector)(z),[d,p]=(0,P.useState)(!0),c=()=>{let l="";if(!m){r(K(l));return}u||(l=t("developer_mode_network_errortip_cannotspace"),r(K(l))),r(K(l))};(0,Oe.useDebounceEffect)(()=>{(async()=>{if(!m||f)return;let l;_(!0);try{r(G("")),l=await mr(m),r(G(l))}catch{}finally{p(l),_(!1)}})()},[m],{wait:500});let I=t("extension_wallet_addnetwork_placeholder_symbol");return P.default.createElement("div",{className:"net-form__wrap-input"},P.default.createElement(y,{value:u,disabled:s||f||d,onBlur:c,size:y.SIZE.xl,errorType:y.TIP_TYPE.always,error:a,tips:e,onChange:i,suffix:n&&P.default.createElement(C.Circle,{size:C.SIZE.sm}),placeholder:I,label:t("developer_mode_network_title_tokenname")}))});h();w();var E=v(L()),F=v(A());$();h();w();sr();function Ge(o){return Number.isSafeInteger(o)&&o>0&&o<=me}var Ke=E.default.memo(o=>{let{disabled:s,modify:f}=o,r=(0,F.useDispatch)(),i=({target:{value:x}})=>{r(O(x.trim()))},[u,a]=(0,E.useState)(!1),{chainId:e,chainIdErr:n,chainIdTip:_,fieldUpdated:m}=(0,F.useSelector)(z),{rpcUrl:d}=(0,F.useSelector)(H),{rpcNetworks:p}=D(),c=(x,b,k=e)=>{r(j({err:x,validChainId:k})),r(ke({tip:b,validChainId:k}))},I=()=>{let x="",b="";if(!e)return x=t("developer_mode_network_errortip_cannotspace"),c(x,b);let k=e,ae=10;if(!k.startsWith("0x"))try{k=`0x${V(k)}`}catch{x=t("developer_mode_infor_errortip_errorchainid")}let[le]=p.filter(S=>S.chainId===k&&S.rpcUrl!==d);if(le?b=t("developer_mode_infor_errortip_network",{network:le.name}):e.startsWith("0x")?(ae=16,/^0x[0-9a-f]+$/iu.test(e)||(x=t("developer_mode_infor_errortip_errornum"))):/^[0-9]+$/u.test(e)?e.startsWith("0")?x=t("developer_mode_infor_errortip_errornum"):Ge(parseInt(e,ae))||(x=t("developer_mode_infor_errortip_errorchainid")):x=t("developer_mode_infor_errortip_errornum"),!d||u||x)return c(x,b);a(!0),J(d).then(S=>{if(k!==S){if(!e.startsWith("0x"))try{S=parseInt(S,16).toString(10)}catch(ir){console.log(ir)}x=t("developer_mode_infor_errortip_chainid",{chainID:S})}c(x,b,e),a(!1)}).catch(()=>{b=t("developer_mode_infor_errortip_rpcurl_confirm"),a(!1),c(x,b,e)})},l=t("extension_wallet_addnetwork_placeholder_chainid");return E.default.createElement("div",{className:"net-form__wrap-input"},E.default.createElement(y,{value:e,disabled:s||!!f,size:y.SIZE.xl,errorType:y.TIP_TYPE.always,error:n,onBlur:I,tips:_,onChange:i,suffix:u&&m&&E.default.createElement(C.Circle,{size:C.SIZE.sm}),placeholder:l,label:E.default.createElement(E.default.Fragment,null,t("developer_mode_network_title_chainid"),E.default.createElement(oe,{title:t("developer_mode_network_tooltip_display_decimal"),placement:oe.DIRECTION.topRight},E.default.createElement(pe,{className:"okx-wallet-plugin-information-circle"})))}))});h();w();var R=v(L()),Y=v(A()),Ve=v(Pe());$();h();w();var Qe=o=>{let{modify:s,uniqueId:f,onDeleteNet:r}=o,i=(0,Ve.useHistory)(),u=(0,Y.useSelector)(Ie),a=Be(),{rpcNetworks:e,updateRpcNetwork:n,addRpcNetwork:_}=D(),{extensionConfig:m,setExtensionConfig:d}=Ae("rpc_info"),p=(0,Y.useDispatch)(),c=(0,Y.useSelector)(xe),I=e.find(b=>W(b,{uniqueId:f}))||{},l=(0,R.useRef)(!1),x=async()=>{if(!l.current){if(l.current=!0,s){let b=await n({...I,...c});W(b,m)&&await d(b);let k={...c,chainId:`0x${V(c.chainId)}`};a(k),i.replace(`${he}?tab=2`)}else{let b=await _(c);await p(ie("isRpcMode",!0)),await p(ie("currentNetworkUniqueId",b?.uniqueId)),await d(b),i.replace(we)}l.current=!1}};return R.default.createElement($e.FooterActions,{usePortal:!0},s&&R.default.createElement(T,{category:T.CATEGORY.outline,type:T.TYPE.primary,size:T.SIZE.lg,onClick:r,className:"net-form__footer-delete-btn",contentClassName:"net-form__footer-delete-btn__text"},t("commonall_resultpage_btn_delete")),R.default.createElement(T,{disabled:u,category:T.CATEGORY.fill,type:T.TYPE.highlight,size:T.SIZE.lg,onClick:x},t("developer_mode_bot_btn_save")))};h();w();var ee=v(L()),re=v(A()),Xe=v(se());$();var Je=ee.default.memo(o=>{let{disabled:s}=o,f=(0,re.useDispatch)(),r=({target:{value:n}})=>{f(Ce(n.trim()))},{explorerUrl:i,explorerUrlErr:u}=(0,re.useSelector)(ye),a=()=>{let n="";i&&(Xe.default.isWebUri(i)||(X(i)?n=t("developer_mode_infor_errortip_invalidurl"):n=t("developer_mode_infor_errortip_https1"))),f(Te(n))},e=t("extension_wallet_addnetwork_placeholder_blockchain");return ee.default.createElement("div",{className:"net-form__wrap-input"},ee.default.createElement(y,{value:i,onBlur:a,disabled:s,size:y.SIZE.xl,errorType:y.TIP_TYPE.always,error:u,onChange:r,placeholder:e,label:t("developer_mode_network_title_blockchain_explorer")}))});var Vt=()=>{let o=(0,er.useDispatch)(),s=(0,rr.useHistory)(),f=Re(),r=f.get("modify"),i=r===We.CANT,u=decodeURIComponent(f.get("id")),{rpcNetworks:a}=D(),e=a.find(p=>W(p,{uniqueId:u}))||{};(0,g.useEffect)(()=>{let p={...e};p.chainId&&(p.chainId=`${Number.parseInt(p.chainId,16)}`),o(Se(p))},[e]),(0,tr.useUnmount)(()=>{o(Ue())});let n=(0,g.useCallback)(()=>{s.action==="POP"?s.replace(ue):s.goBack()},[s]),_=Me(),m=(0,g.useCallback)(()=>{_({editRpcInfo:e,onDeleted:n})},[_,n,e]),d=(0,g.useMemo)(()=>g.default.createElement("div",{className:"net-form__title"},e.name?g.default.createElement(g.default.Fragment,null,g.default.createElement(ne,{size:ne.SIZE.md,src:e.icon,text:e.name,className:"net-form__title-icon",defaultIcon:De}),g.default.createElement("div",{className:"net-form__title-text net-form__title-text-top"},e.name)):g.default.createElement("div",{className:"net-form__title-text"},t("wallet_extension_settings_header_custom_network"))),[e]);return g.default.createElement("div",{className:(0,or.default)("net-form",{disabled:i})},g.default.createElement(ze,{onBack:n,closeable:!1}),i||r?null:g.default.createElement(te,{className:"net-form__warn",desc:t("developer_mode_network_errortip_trust_network"),type:te.TYPE.warn,closable:!1}),d,g.default.createElement("div",{className:"net-form__wrap"},g.default.createElement(Ze,{disabled:i}),g.default.createElement(He,{disabled:i,modify:r}),g.default.createElement(Ke,{disabled:i,modify:r}),g.default.createElement(je,{disabled:i,modify:r}),g.default.createElement(Je,{disabled:i}),!i&&g.default.createElement(Qe,{modify:r,uniqueId:u,onDeleteNet:m})))};export{Vt as default};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=Form-CEBBKQMG.js.map
