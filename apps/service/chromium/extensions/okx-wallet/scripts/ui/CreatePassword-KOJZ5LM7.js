import{b as ze}from"./chunk-46OYQ6W4.js";import{a as ve,b as He,c as Ke,d as Ve}from"./chunk-ZLQG6XAC.js";import{d as Ue}from"./chunk-QBO66WYA.js";import{a as y,b as De}from"./chunk-MSEKW37V.js";import"./chunk-LVFFHQXT.js";import"./chunk-N5KXYLI6.js";import"./chunk-G6PPKZHQ.js";import{a as Fe}from"./chunk-2P7I7CKT.js";import{b as we,c as he,d as _e,e as ge,f as be,g as Ce,l as Pe,m as Ee,n as ke,o as ye}from"./chunk-BETSGZLN.js";import"./chunk-2R2FRPW3.js";import"./chunk-PREZW222.js";import{a as Ne,b as Oe}from"./chunk-KPMUK7JJ.js";import"./chunk-GRXKA7HE.js";import"./chunk-SNFTVDFG.js";import{T as q,m as ne}from"./chunk-ZV6IBWDM.js";import"./chunk-4HGOSSS7.js";import"./chunk-OIXVONQI.js";import"./chunk-REMRMZNH.js";import"./chunk-74FNJDB7.js";import{c as We}from"./chunk-G7B74XXT.js";import{a as Le}from"./chunk-YYUUDQVK.js";import"./chunk-RJDGREGT.js";import"./chunk-HJB4XHU5.js";import"./chunk-QR7BG2TV.js";import"./chunk-5XL3JGAU.js";import{c as Me,f as Be,g as Q,h as J}from"./chunk-QJFOLFSE.js";import"./chunk-DJ76J5SU.js";import"./chunk-AKJZXDVD.js";import"./chunk-E75DNWM4.js";import"./chunk-GOMM7VSE.js";import{l as ce,m as le,n as pe,o as de}from"./chunk-LTMEFQRN.js";import"./chunk-MSUJSPID.js";import{h as Ae,i as Re}from"./chunk-TU5XNYNZ.js";import{a as xe}from"./chunk-MZFOYMI4.js";import"./chunk-EQ275TZX.js";import{F as ue,Ta as fe,a as W}from"./chunk-WSXZYUQ4.js";import"./chunk-JRZXGORL.js";import"./chunk-IRNZUYU4.js";import"./chunk-SFTZ55EP.js";import"./chunk-DZHQUYHS.js";import{o as Se}from"./chunk-AUURQ3HI.js";import{cc as Te,wb as Ie}from"./chunk-B32MCU7F.js";import"./chunk-QCINCBGO.js";import"./chunk-VOLYN562.js";import{a as uo}from"./chunk-VLKJDIZ5.js";import{ua as ie,za as lo}from"./chunk-N4B7HQY5.js";import{d as me,f as po}from"./chunk-TKFT6XV3.js";import"./chunk-MBLN6WQR.js";import"./chunk-OWU5GWTN.js";import"./chunk-2BGRD7AD.js";import"./chunk-TCJNKUJ2.js";import"./chunk-2UKLMOTV.js";import"./chunk-ZWQEMYA4.js";import"./chunk-ELX2GHLL.js";import"./chunk-AIPMH74P.js";import"./chunk-DJDG7W5Q.js";import{ic as re,kc as se,o as oe,qc as co,u as te,z as mo}from"./chunk-Q23SA7M6.js";import"./chunk-XXICVAVV.js";import{D as k,H as ae,q as x,r as j}from"./chunk-E44TZGUB.js";import{F as Z,oa as io}from"./chunk-KBQXBPIW.js";import{O as ee,w as f}from"./chunk-364XNTHB.js";import"./chunk-NBWNTERD.js";import"./chunk-GBTEQNFM.js";import"./chunk-QBHNZ2BL.js";import"./chunk-J6E3F25X.js";import{ca as S}from"./chunk-W7JONHX2.js";import"./chunk-O3LHCDGR.js";import{a as $}from"./chunk-PDSGFBX4.js";import"./chunk-GAMT4PKF.js";import"./chunk-R4QAJG6J.js";import"./chunk-LI7MZD2P.js";import"./chunk-WTNDHHRR.js";import"./chunk-CGP26AOO.js";import"./chunk-2RHSM47Y.js";import"./chunk-3MCJH4Z7.js";import"./chunk-AGN4QMRN.js";import"./chunk-3SRT54EN.js";import"./chunk-J5P7OMUC.js";import"./chunk-3CPUV3E7.js";import"./chunk-SHMKQUVK.js";import{f as g,o as n,q as i}from"./chunk-FJHLV356.js";n();i();var s=g($()),F=g(Te()),D=g(Se());io();ee();po();n();i();var I=g($()),L=g(Te()),Ye=g(uo());function Ge(){let m=(0,L.useDispatch)(),t=(0,Ye.useHistory)(),a=(0,L.useSelector)(Ie),[c,r]=(0,I.useState)(!1);return(0,I.useEffect)(()=>{a&&!c&&t.push(W)},[a,c,t,m]),(0,I.useCallback)(()=>{r(!0)},[])}co();n();i();var Ze=m=>{let{onboardingTabs:t}=m.metamask;if(!t||Object.keys(t).length!==1)return null;let a=Object.keys(t)[0],c=t[a];return{location:a,tabId:c}};mo();lo();n();i();var p=g($());ee();var $e=({onSubmit:m,formClass:t,itemClass:a,formErrorClass:c,setFormValues:r,showBiometrics:U,biometricsChecked:P,setBiometricsChecked:R,bulkButtonStyle:v={},disabled:M,loading:H,showConfirm:o=!0,showForgetPassword:b=!1,showPasswordIndicator:C=!0,forgetPwdFrom:K="",forgetPasswordPath:E})=>{let B=k.useForm();return p.default.createElement(k,{form:B,size:S.SIZE.lg,onSubmit:m,validateTrigger:["onChange"],className:t,errorClassName:c,onValuesChange:(d,u)=>{r(u)}},p.default.createElement(k.Item,{name:"password",style:{marginBottom:"0px"},className:a},p.default.createElement(x.Password,{autoFocus:!0,autoComplete:"off",inputClassName:y.passwordInput,size:x.SIZE.xl,placeholder:f("wallet_set_password_maintitle_enter_password")})),C&&p.default.createElement(k.Item,{noStyle:!0,shouldUpdate:(d,u)=>d.password!==u.password},({getFieldValue:d})=>{let u=d("password");return p.default.createElement(Oe,{password:u})}),o&&p.default.createElement(k.Item,{name:"confirmPassword",style:{flex:1,margin:"16px 0px 0px"},dependencies:["password"],className:a,rules:[({getFieldValue:d})=>({validator:(u,N)=>{let V=d("password");return N&&V!==N?Promise.reject(f("wallet_set_password_errortip_password_not_match")):Promise.resolve()}})]},p.default.createElement(x.Password,{autoComplete:"off",inputClassName:y.passwordInput,size:x.SIZE.xl,placeholder:f("wallet_set_password_input_reenter")})),U&&p.default.createElement(j,{className:y.biometricsCheckBoxWrapper,size:j.SIZE.sm,checked:P,textClass:y.biometricsCheckBox,onChange:d=>{let u=!!d?.target?.checked;R(u)}},f("wallet_extension_onboard_chips_touch_id")),b&&p.default.createElement(We,{className:y.forgot,from:K,replace:!0,path:E}),p.default.createElement(xe.FooterActions,{affixStyle:v,renderNative:!0,buttonGroup:[{loading:H,disabled:M,block:!0,type:S.TYPE.highlight,category:S.CATEGORY.fill,size:S.SIZE.lg,onClick:m,btnText:f("wallet_set_password_btn_confirm")}]}))};n();i();function je(){return[!1,!1]}n();i();var qe=g(Se());function fo(m=""){let t=m==="create"?"create_wallet":"import_wallet";return(0,qe.useMount)(()=>{try{Be({source:t,platform:Q(),tg_platform:J()})}catch{}}),{confirmMonitor:c=>{try{Me({platform:Q(),tg_platform:J(),is_biometrics_enabled:c?"yes":"no",source:t})}catch{}}}}var Qe=fo;var _={SEED:"seed",KEY:"key",HARDWARE:"hardware",CREATE:"create",MPC:"mpc",BULK:"bulk"},wt=({history:m})=>{let t=Fe(),[a,{set:c}]=(0,D.useBoolean)(!1),[r,U]=(0,s.useState)({}),[P,R]=(0,s.useState)(!1),[v,M]=je(),H=Ve(),o=(0,F.useDispatch)(),{seedPhrase:b,privateKey:C,mpcInfo:K,unlockHardwareWallets:E,chooseNetworkList:B,isTonMnemonic:d}=(0,F.useSelector)(e=>({seedPhrase:we(e),privateKey:he(e),mpcInfo:ge(e),unlockHardwareWallets:_e(e),chooseNetworkList:be(e),onboardingInitiator:Ze(e),isTonMnemonic:Ce(e)})),u=re()===te?"telegram":"extension",N=Ge(),V=Ke(),z=t.get("from"),Je=z===_.HARDWARE,Xe=He(),O=z===_.BULK,{setValue:eo}=Ue(),{confirmMonitor:oo}=Qe(z),T=async(e,w)=>{try{o(ze(!0)).then(async()=>{if(N(),await o(Le()),V(e))return;if(e===_.CREATE){Xe();return}let h=`${ue}/${e}`,{keyringName:G="",walletName:l=""}=w||{},no=`${G}-${l}`;if(e===_.HARDWARE&&se()===oe){globalThis.platform.openExtensionInPopup(`${h}?anim=1`);return}m.push({pathname:h,state:{walletName:no,anim:"1",next:W}})}).catch(()=>{})}catch{}},X=s.default.useMemo(()=>{let{password:e,confirmPassword:w}=r;return!(e?.length>=Ne&&e===w)},[a,C,b,E,r]),to=(0,D.useMemoizedFn)(async()=>{if(q(),b){let l=await o(le(r.password,{mnemonic:b?.trim().toLowerCase().match(/\w+/gu)?.join(" ")||"",isTonMnemonic:d}));T(_.SEED,l),o(Pe())}if(C){let l=await o(pe(r.password,{privateKey:C,baseChains:B}));T(_.KEY,l),o(Ee())}if(O){eo(r.password),m.push(fe);return}let{cipherText:e,privateKey:w,mpcId:h,userInfo:G}=K;if(e&&w&&h){let l=await o(de(r.password,{cipherText:e,privateKey:w},{mpcId:h,userInfo:G},!0));T(_.MPC,l),o(ye())}if(!Z(E)){await me().setPassword(r.password,!0);let l=await o(ve(E));T(_.HARDWARE,l),o(ke())}if(!b&&!C&&!(e&&w&&h)&&Z(E)){let l=await o(ce(r.password));T(_.CREATE,l)}},[X,r,b,C,B]),ro=()=>H(r?.password),Y=(0,s.useRef)(P);(0,s.useEffect)(()=>{Y.current=P},[P]);let so=async()=>{c(!0),oo(Y.current),q();try{Y.current?await ro():(await to(),o(Ae(1)),o(Re(void 0)),ne({button_name:"biometric",platform:u}))}catch(e){e.message===ie&&ae.error(f("wallet_home_toast_network_error"))}finally{c(!1)}};(0,s.useEffect)(()=>{if(O){let e=document.querySelector("#app");e&&(e.classList.remove("fullscreen"),e.classList.add("popup"))}return()=>{if(O){let e=document.querySelector("#app");e&&(e.classList.remove("popup"),e.classList.add("fullscreen"))}}},[]),(0,s.useEffect)(()=>{R(M)},[M]);let ao=O?{position:"absolute",bottom:0,left:0}:{};return s.default.createElement(De,{title:f("wallet_signup_maintitle_set_password"),desc:f(Je?"wallet_extension_signup_subtitle_set_password_hardware":"wallet_extension_subtitle_password_unlock")},({formClass:e,formErrorClass:w,itemClass:h})=>s.default.createElement($e,{onSubmit:so,formClass:e,itemClass:h,formErrorClass:w,setFormValues:U,showBiometrics:v,biometricsChecked:P,setBiometricsChecked:R,bulkButtonStyle:ao,disabled:X,loading:a}))};export{wt as default};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=CreatePassword-KOJZ5LM7.js.map
