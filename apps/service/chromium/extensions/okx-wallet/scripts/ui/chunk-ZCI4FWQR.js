import{a as be}from"./chunk-WTNDHHRR.js";import{b as V}from"./chunk-TKZ7N5JX.js";import{c as w,o as g,p as m,q as p}from"./chunk-FJHLV356.js";var Ee=w($=>{"use strict";g();p();Object.defineProperty($,"__esModule",{value:!0});$.Assignable=$.Enum=void 0;var ve=class{constructor(r){if(Object.keys(r).length!==1)throw new Error("Enum can only take single value");Object.keys(r).map(t=>{this[t]=r[t],this.enum=t})}};$.Enum=ve;var he=class{constructor(r){Object.keys(r).map(t=>{this[t]=r[t]})}};$.Assignable=he});var Se=w(P=>{"use strict";g();p();Object.defineProperty(P,"__esModule",{value:!0});P.BinaryReader=P.BinaryWriter=P.BorshError=P.deserialize=P.serialize=P.base_decode=P.base_encode=void 0;var D=be();Object.defineProperty(P,"base_encode",{enumerable:!0,get:function(){return D.baseEncode}});Object.defineProperty(P,"base_decode",{enumerable:!0,get:function(){return D.baseDecode}});Object.defineProperty(P,"serialize",{enumerable:!0,get:function(){return D.serialize}});Object.defineProperty(P,"deserialize",{enumerable:!0,get:function(){return D.deserialize}});Object.defineProperty(P,"BorshError",{enumerable:!0,get:function(){return D.BorshError}});Object.defineProperty(P,"BinaryWriter",{enumerable:!0,get:function(){return D.BinaryWriter}});Object.defineProperty(P,"BinaryReader",{enumerable:!0,get:function(){return D.BinaryReader}})});var Te=w(U=>{"use strict";g();p();Object.defineProperty(U,"__esModule",{value:!0});U.PublicKey=U.KeyType=void 0;var Ze=Ee(),Ke=Se(),Ye=V(),J;(function(e){e[e.ED25519=0]="ED25519"})(J=U.KeyType||(U.KeyType={}));function Qe(e){switch(e){case J.ED25519:return"ed25519";default:throw new Error(`Unknown key type ${e}`)}}function er(e){switch(e.toLowerCase()){case"ed25519":return J.ED25519;default:throw new Error(`Unknown key type ${e}`)}}var I=class extends Ze.Assignable{static fromRaw(r){return new I({keyType:J.ED25519,data:r})}static from(r){return typeof r=="string"?I.fromString(r):r}static fromString(r){let t=r.split(":");if(t.length===1)return new I({keyType:J.ED25519,data:(0,Ke.base_decode)(t[0])});if(t.length===2)return new I({keyType:er(t[0]),data:(0,Ke.base_decode)(t[1])});throw new Error("Invalid encoded key format, must be <curve>:<encoded key>")}toString(){return`${Qe(this.keyType)}:${(0,Ke.base_encode)(this.data)}`}verify(r,t){switch(this.keyType){case J.ED25519:return Ye.signUtil.ed25519.verify(r,t,this.data);default:throw new Error(`Unknown key type ${this.keyType}`)}}};U.PublicKey=I});var Pe=w(de=>{"use strict";g();p();Object.defineProperty(de,"__esModule",{value:!0});de.SignType=void 0;var rr;(function(e){e[e.Secp256k1=1]="Secp256k1",e[e.ECDSA_P256=2]="ECDSA_P256",e[e.ED25519=3]="ED25519",e[e.StarknetSignType=4]="StarknetSignType",e[e.TezosSignType=5]="TezosSignType"})(rr=de.SignType||(de.SignType={}))});var He=w(x=>{"use strict";g();p();Object.defineProperty(x,"__esModule",{value:!0});x.CoinCurveMap=x.MultiAddressCoins=x.segwitType=x.Currency=void 0;var d;(function(e){e[e.NULL=-1]="NULL",e[e.BTC=0]="BTC",e[e.TBTC=1]="TBTC",e[e.ETH=60]="ETH",e[e.LTC=2]="LTC",e[e.DOGE=3]="DOGE",e[e.BCH=145]="BCH",e[e.BSV=236]="BSV",e[e.TRX=195]="TRX",e[e.SOL=501]="SOL",e[e.APTOS=637]="APTOS",e[e.OMNI_USDT=20001]="OMNI_USDT",e[e.OMNI_USDT_TEST=20002]="OMNI_USDT_TEST",e[e.SUI=784]="SUI",e[e.ATOM=118]="ATOM",e[e.OSMO=1e3]="OSMO",e[e.EVMOS=1001]="EVMOS",e[e.AXL=1002]="AXL",e[e.CRO=1003]="CRO",e[e.Iris=1004]="Iris",e[e.Juno=1005]="Juno",e[e.Kava=1006]="Kava",e[e.Kujira=1007]="Kujira",e[e.SCRT=1008]="SCRT",e[e.Stargaze=1009]="Stargaze",e[e.Terra=1010]="Terra",e[e.ZKSPACE=1011]="ZKSPACE",e[e.ZKSYNC=804]="ZKSYNC",e[e.Stx=5757]="Stx",e[e.SEI=2837]="SEI",e[e.WAX=14001]="WAX",e[e.Starknet=9004]="Starknet",e[e.ADA=1815]="ADA",e[e.INJ=2892]="INJ",e[e.Celestia=2854]="Celestia",e[e.DYDX=2897]="DYDX",e[e.Kaspa=111111]="Kaspa",e[e.TON=607]="TON",e[e.NostrAssets=1237]="NostrAssets",e[e.Near=397]="Near"})(d=x.Currency||(x.Currency={}));var tr;(function(e){e[e.SEGWIT_NESTED=1]="SEGWIT_NESTED",e[e.SEGWIT_NESTED_49=2]="SEGWIT_NESTED_49",e[e.SEGWIT_NATIVE=3]="SEGWIT_NATIVE",e[e.SEGWIT_TAPROOT=4]="SEGWIT_TAPROOT"})(tr=x.segwitType||(x.segwitType={}));x.MultiAddressCoins=[d.BTC,d.TBTC,d.LTC,d.DOGE,d.BSV,d.OMNI_USDT,d.OMNI_USDT_TEST];var y="secp256k1",ge="ed25519";x.CoinCurveMap=new Map([[d.BTC,y],[d.TBTC,y],[d.ETH,y],[d.LTC,y],[d.DOGE,y],[d.BCH,y],[d.BSV,y],[d.TRX,y],[d.OMNI_USDT,y],[d.OMNI_USDT_TEST,y],[d.ATOM,y],[d.OSMO,y],[d.EVMOS,y],[d.AXL,y],[d.CRO,y],[d.Iris,y],[d.Juno,y],[d.Kava,y],[d.Kujira,y],[d.SCRT,y],[d.Stargaze,y],[d.Terra,y],[d.SEI,y],[d.Celestia,y],[d.DYDX,y],[d.SOL,ge],[d.APTOS,ge],[d.SUI,ge],[d.TON,ge]])});var we=w(o=>{"use strict";g();p();Object.defineProperty(o,"__esModule",{value:!0});o.SignCommonMsgError=o.EstimateFeeError=o.validSignedTransactionError=o.GetPayLoadError=o.HardwareDerivePubKeyError=o.CalcTxHashError=o.SignMsgStep3Error=o.SignMsgSetupError=o.Ed25519Step3Error=o.Ed25519Step2Error=o.Ed25519Step1Error=o.Ed25519SetupError=o.EcdsaStep3Error=o.EcdsaStep2Error=o.EcdsaStep1Error=o.EcdsaSetupError=o.MPCShakeHandsError=o.MPCStepError=o.MPCAesKeyMissError=o.GetHardWareMessageHashError=o.GetHardwareSignedTransactionError=o.GetHardwareRawTransactionError=o.GetMpcTransactionError=o.GetMpcRawTransactionError=o.DerivePathError=o.GenMnemonicError=o.GenPrivateKeyError=o.UnsupportedCoinError=o.SignMsgError=o.SignTxError=o.ValidAddressError=o.NewAddressError=o.NotImplementedError=void 0;o.NotImplementedError="no implementation method";o.NewAddressError="generate address error";o.ValidAddressError="valid address error";o.SignTxError="sign tx error";o.SignMsgError="sign message error";o.UnsupportedCoinError="unsupported currency";o.GenPrivateKeyError="generate private key error";o.GenMnemonicError="generate mnemonic error";o.DerivePathError="derive hdPath error";o.GetMpcRawTransactionError="get mpc raw transaction error";o.GetMpcTransactionError="get mpc transaction error";o.GetHardwareRawTransactionError="get hardware raw transaction error";o.GetHardwareSignedTransactionError="get hardware signed transaction error";o.GetHardWareMessageHashError="get hardware message hash error";o.MPCAesKeyMissError="mpc get aes key error";o.MPCStepError="mpc step error";o.MPCShakeHandsError="mpc shake hands error";o.EcdsaSetupError="ecdsa setup error";o.EcdsaStep1Error="ecdsa step1 error";o.EcdsaStep2Error="ecdsa step2 error";o.EcdsaStep3Error="ecdsa step3 error";o.Ed25519SetupError="ed25519 setup error";o.Ed25519Step1Error="ed25519 step1 error";o.Ed25519Step2Error="ed25519 step2 error";o.Ed25519Step3Error="ed25519 step3 error";o.SignMsgSetupError="sign message setup error";o.SignMsgStep3Error="sign message step3 error";o.CalcTxHashError="calculate tx hash error";o.HardwareDerivePubKeyError="derive sub pub key error";o.GetPayLoadError="get payload error";o.validSignedTransactionError="valid signed transaction error";o.EstimateFeeError="estimate fee error";o.SignCommonMsgError="sign common msg error"});var je=w(_=>{"use strict";g();p();Object.defineProperty(_,"__esModule",{value:!0});_.jsonStringifyUniform=_.cloneObject=_.assertBufferLength=_.convert2BigNumber=_.convert2Number=_.buildCommonSignMsg=void 0;var pe=V();function sr(e,r){return`OKX Wallet Sign In

publicKey: ${e}
walletId: ${r}
host: api.wallet.okx
OKX Wallet Sign In`}_.buildCommonSignMsg=sr;function nr(e){if(e!=null)return typeof e=="string"?parseInt(e):e}_.convert2Number=nr;function ir(e){if(e!=null)return pe.BigNumber.isBigNumber(e)?e:new pe.BigNumber(e)}_.convert2BigNumber=ir;function or(e,r){if(e.length!=r)throw Error("buffer length is illegal")}_.assertBufferLength=or;function ar(e){return JSON.parse(JSON.stringify(e))}_.cloneObject=ar;function cr(e){return JSON.stringify(e,(r,t)=>t&&(t.type==="Buffer"||t instanceof Uint8Array?pe.base.toHex(t):typeof t=="bigint"?t.toString():t))}_.jsonStringifyUniform=cr});var _e=w(W=>{"use strict";g();p();var dr=W&&W.__createBinding||(Object.create?function(e,r,t,s){s===void 0&&(s=t);var a=Object.getOwnPropertyDescriptor(r,t);(!a||("get"in a?!r.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return r[t]}}),Object.defineProperty(e,s,a)}:function(e,r,t,s){s===void 0&&(s=t),e[s]=r[t]}),lr=W&&W.__exportStar||function(e,r){for(var t in e)t!=="default"&&!Object.prototype.hasOwnProperty.call(r,t)&&dr(r,e,t)};Object.defineProperty(W,"__esModule",{value:!0});lr(je(),W)});var Ge=w(b=>{"use strict";g();p();Object.defineProperty(b,"__esModule",{value:!0});b.SimpleWallet=b.BaseWallet=b.ecdsaSign=b.fromSigned=b.padWithZeroes=b.toUnsigned=b.intToHex=b.makeSignature=b.secp256k1SignTest=void 0;var E=we(),Z=Pe(),S=V(),ur=_e();function Ie(e){let r=S.base.sha256("secp256k1-test"),t=S.signUtil.secp256k1.publicKeyCreate(e,!1),{signature:s,recovery:a}=S.signUtil.secp256k1.sign(m.Buffer.from(r),e);return S.signUtil.secp256k1.verify(r,s,a,t)}b.secp256k1SignTest=Ie;function De(e,r,t){let s=(0,b.fromSigned)(r),a=(0,b.fromSigned)(t),u=e,n=Ae((0,b.toUnsigned)(s).toString("hex"),64),l=Ae((0,b.toUnsigned)(a).toString("hex"),64);return S.base.stripHexPrefix(Ue(u)).concat(n,l)}b.makeSignature=De;function Ue(e){return`0x${e.toString(16)}`}b.intToHex=Ue;var fr=function(e){return m.Buffer.from(e.toTwos(256).toArray())};b.toUnsigned=fr;function Ae(e,r){if(e!==""&&!/^[a-f0-9]+$/iu.test(e))throw new Error(`Expected an unprefixed hex string. Received: ${e}`);if(r<0)throw new Error(`Expected a non-negative integer target length. Received: ${r}`);return String.prototype.padStart.call(e,r,"0")}b.padWithZeroes=Ae;var gr=function(e){return new S.BN(e).fromTwos(256)};b.fromSigned=gr;function We(e,r,t){let{signature:s,recovery:a}=S.signUtil.secp256k1.sign(e,r),u=m.Buffer.from(s.slice(0,32)),n=m.Buffer.from(s.slice(32,64));if(t&&!Number.isSafeInteger(t))throw new Error("The provided number is greater than MAX_SAFE_INTEGER (please use an alternative input type)");return{v:t?a+(t*2+35):a+27,r:u,s:n}}b.ecdsaSign=We;var ye=class{getRandomPrivateKey(){try{for(;;){let r=S.base.randomBytes(32);if(Ie(r))return Promise.resolve(S.base.toHex(r,!0))}}catch{}return Promise.reject(E.GenPrivateKeyError)}getDerivedPrivateKey(r){return S.bip39.mnemonicToSeed(r.mnemonic).then(t=>{let s=S.bip32.fromSeed(t).derivePath(r.hdPath);if(s.privateKey){let a=S.base.toHex(s.privateKey);return Promise.resolve("0x"+a)}else return Promise.reject(E.GenPrivateKeyError)}).catch(t=>Promise.reject(E.GenPrivateKeyError))}getDerivedPath(r){return Promise.reject(E.NotImplementedError)}validPrivateKey(r){return Promise.reject(E.NotImplementedError)}signMessage(r){return Promise.reject(E.NotImplementedError)}async signCommonMsg(r){r.signType||(r.signType=Z.SignType.Secp256k1);let t;if(r.message.text)t=r.message.text;else{let l;if(r.publicKey?l=r.publicKey:l=(await this.getNewAddress({privateKey:r.privateKey,addressType:r.addressType,hrp:r.hrp,version:r.version})).publicKey,l.startsWith("0x")&&(l=l.substring(2)),!r.message.walletId)return Promise.reject("invalid walletId");t=(0,ur.buildCommonSignMsg)(l,r.message.walletId)}let s=S.base.magicHash(t),a=r.privateKeyHex?r.privateKeyHex:r.privateKey,u=S.base.fromHex(a);var n;switch(r.signType){case Z.SignType.Secp256k1:let{v:l,r:h,s:K}=We(m.Buffer.from(s),u);return Promise.resolve(De(l,h,K));case Z.SignType.ECDSA_P256:return n=S.signUtil.p256.sign(m.Buffer.from(s),u).signature,Promise.resolve(S.base.toHex(n));case Z.SignType.ED25519:return n=S.signUtil.ed25519.sign(s,u),Promise.resolve(S.base.toHex(n));case Z.SignType.StarknetSignType:return n=S.signUtil.schnorr.stark.sign(s,u).toCompactRawBytes(),Promise.resolve(S.base.toHex(n));case Z.SignType.TezosSignType:return Promise.reject("not support")}}verifyMessage(r){return Promise.reject(E.NotImplementedError)}ecRecover(r,t){return Promise.reject(E.NotImplementedError)}getAddressByPublicKey(r){return Promise.reject(E.NotImplementedError)}getMPCRawTransaction(r){return Promise.reject(E.NotImplementedError)}getMPCTransaction(r){return Promise.reject(E.NotImplementedError)}getMPCRawMessage(r){return Promise.reject(E.NotImplementedError)}getMPCSignedMessage(r){return Promise.reject(E.NotImplementedError)}getHardWareRawTransaction(r){return Promise.reject(E.NotImplementedError)}getHardWareSignedTransaction(r){return Promise.reject(E.NotImplementedError)}getHardWareMessageHash(r){return Promise.reject(E.NotImplementedError)}calcTxHash(r){return Promise.reject(E.NotImplementedError)}getRawTransaction(r){return Promise.reject(E.NotImplementedError)}validSignedTransaction(r){return Promise.reject(E.NotImplementedError)}estimateFee(r){return Promise.reject(E.NotImplementedError)}};b.BaseWallet=ye;var xe=class extends ye{mockData(r,t){this.mockAddress=r,this.mockPublicKey=t}getNewAddress(r){return Promise.resolve({address:this.mockAddress,publicKey:this.mockPublicKey})}validAddress(r){throw new Error("Method not implemented.")}signTransaction(r){throw new Error("Method not implemented.")}};b.SimpleWallet=xe});var ke=w(B=>{"use strict";g();p();var pr=B&&B.__createBinding||(Object.create?function(e,r,t,s){s===void 0&&(s=t);var a=Object.getOwnPropertyDescriptor(r,t);(!a||("get"in a?!r.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return r[t]}}),Object.defineProperty(e,s,a)}:function(e,r,t,s){s===void 0&&(s=t),e[s]=r[t]}),le=B&&B.__exportStar||function(e,r){for(var t in e)t!=="default"&&!Object.prototype.hasOwnProperty.call(r,t)&&pr(r,e,t)};Object.defineProperty(B,"__esModule",{value:!0});le(Pe(),B);le(He(),B);le(we(),B);le(Ge(),B);le(_e(),B)});var Me=w(me=>{"use strict";g();p();Object.defineProperty(me,"__esModule",{value:!0});me.MessagePayload=void 0;var Be=class{constructor(r){this.tag=2147484061,this.message=r.message,this.nonce=r.nonce,this.recipient=r.recipient,r.callbackUrl&&(this.callbackUrl=r.callbackUrl)}};me.MessagePayload=Be});var ze=w(i=>{"use strict";g();p();Object.defineProperty(i,"__esModule",{value:!0});i.functionCallAccessKey=i.fullAccessKey=i.signTransaction=i.createTransaction=i.SCHEMA=i.SignedTransaction=i.Signature=i.Action=i.Transaction=i.deleteAccount=i.deleteKey=i.addKey=i.stake=i.transfer=i.functionCall=i.stringifyJsonOrBytes=i.deployContract=i.createAccount=i.DeleteAccount=i.DeleteKey=i.AddKey=i.Stake=i.Transfer=i.FunctionCall=i.DeployContract=i.CreateAccount=i.IAction=i.AccessKey=i.AccessKeyPermission=i.FullAccessPermission=i.FunctionCallPermission=void 0;var G=Te(),H=Ee(),ue=be(),R=V(),yr=Se(),mr=Me(),Y=class extends H.Assignable{};i.FunctionCallPermission=Y;var Q=class extends H.Assignable{};i.FullAccessPermission=Q;var q=class extends H.Enum{};i.AccessKeyPermission=q;var C=class extends H.Assignable{};i.AccessKey=C;var M=class extends H.Assignable{};i.IAction=M;var ee=class extends M{};i.CreateAccount=ee;var re=class extends M{};i.DeployContract=re;var z=class extends M{};i.FunctionCall=z;var te=class extends M{};i.Transfer=te;var se=class extends M{};i.Stake=se;var ne=class extends M{};i.AddKey=ne;var ie=class extends M{};i.DeleteKey=ie;var oe=class extends M{};i.DeleteAccount=oe;function br(){return new A({createAccount:new ee({})})}i.createAccount=br;function vr(e){return new A({deployContract:new re({code:e})})}i.deployContract=vr;function qe(e){return e.byteLength!==void 0&&e.byteLength===e.length?e:m.Buffer.from(JSON.stringify(e))}i.stringifyJsonOrBytes=qe;function hr(e,r,t=new R.BN(0),s=new R.BN(0),a=qe,u=!1){return u?new A({functionCall:new z({methodName:e,args:r,gas:t,deposit:s})}):new A({functionCall:new z({methodName:e,args:a(r),gas:t,deposit:s})})}i.functionCall=hr;function Er(e){return new A({transfer:new te({deposit:e})})}i.transfer=Er;function Sr(e,r){return new A({stake:new se({stake:e,publicKey:r})})}i.stake=Sr;function Kr(e,r){return new A({addKey:new ne({publicKey:e,accessKey:r})})}i.addKey=Kr;function Tr(e){return new A({deleteKey:new ie({publicKey:e})})}i.deleteKey=Tr;function Pr(e){return new A({deleteAccount:new oe({beneficiaryId:e})})}i.deleteAccount=Pr;var N=class extends H.Assignable{encode(){return(0,ue.serialize)(i.SCHEMA,this)}static decode(r){return(0,ue.deserialize)(i.SCHEMA,N,r)}};i.Transaction=N;var A=class extends H.Enum{};i.Action=A;var ae=class extends H.Assignable{};i.Signature=ae;var L=class extends H.Assignable{encode(){return(0,ue.serialize)(i.SCHEMA,this)}static decode(r){return(0,ue.deserialize)(i.SCHEMA,L,r)}};i.SignedTransaction=L;i.SCHEMA=new Map([[mr.MessagePayload,{kind:"struct",fields:[["tag","u32"],["message","string"],["nonce",[32]],["recipient","string"],["callbackUrl",{kind:"option",type:"string"}]]}],[ae,{kind:"struct",fields:[["keyType","u8"],["data",[64]]]}],[L,{kind:"struct",fields:[["transaction",N],["signature",ae]]}],[N,{kind:"struct",fields:[["signerId","string"],["publicKey",G.PublicKey],["nonce","u64"],["receiverId","string"],["blockHash",[32]],["actions",[A]]]}],[G.PublicKey,{kind:"struct",fields:[["keyType","u8"],["data",[32]]]}],[C,{kind:"struct",fields:[["nonce","u64"],["permission",q]]}],[q,{kind:"enum",field:"enum",values:[["functionCall",Y],["fullAccess",Q]]}],[Y,{kind:"struct",fields:[["allowance",{kind:"option",type:"u128"}],["receiverId","string"],["methodNames",["string"]]]}],[Q,{kind:"struct",fields:[]}],[A,{kind:"enum",field:"enum",values:[["createAccount",ee],["deployContract",re],["functionCall",z],["transfer",te],["stake",se],["addKey",ne],["deleteKey",ie],["deleteAccount",oe]]}],[ee,{kind:"struct",fields:[]}],[re,{kind:"struct",fields:[["code",["u8"]]]}],[z,{kind:"struct",fields:[["methodName","string"],["args",["u8"]],["gas","u64"],["deposit","u128"]]}],[te,{kind:"struct",fields:[["deposit","u128"]]}],[se,{kind:"struct",fields:[["stake","u128"],["publicKey",G.PublicKey]]}],[ne,{kind:"struct",fields:[["publicKey",G.PublicKey],["accessKey",C]]}],[ie,{kind:"struct",fields:[["publicKey",G.PublicKey]]}],[oe,{kind:"struct",fields:[["beneficiaryId","string"]]}]]);function Ce(e,r,t,s,a,u){return new N({signerId:e,publicKey:r,nonce:s,receiverId:t,actions:a,blockHash:u})}i.createTransaction=Ce;async function Re(e,r){let t=(0,ue.serialize)(i.SCHEMA,e),s=R.base.sha256(t),a=R.base.fromHex(r),u=R.signUtil.ed25519.sign(s,a),n=new L({transaction:e,signature:new ae({keyType:G.KeyType.ED25519,data:u})});return[s,n]}async function wr(...e){if(e[0].constructor===N){let[r,t]=e;return Re(r,t)}else{let[r,t,s,a,u,n]=e,l=R.signUtil.ed25519.publicKeyCreate(R.base.fromHex(u)),h=G.PublicKey.from((0,yr.base_encode)(l)),K=Ce(n,h,r,t,s,a);return Re(K,u)}}i.signTransaction=wr;function _r(){return new C({nonce:0,permission:new q({fullAccess:new Q({})})})}i.fullAccessKey=_r;function Ar(e,r,t){return new C({nonce:0,permission:new q({functionCall:new Y({receiverId:e,allowance:t,methodNames:r})})})}i.functionCallAccessKey=Ar});var Le=w(F=>{"use strict";g();p();Object.defineProperty(F,"__esModule",{value:!0});F.NearWallet=F.NearTypes=void 0;var T=ke(),c=V(),f=Xe(),xr=Me(),kr=be(),X;(function(e){e[e.TransferNear=0]="TransferNear",e[e.TransferToken=1]="TransferToken",e[e.DAppTx=2]="DAppTx",e[e.DAppTxs=3]="DAppTxs",e[e.AddKey=4]="AddKey",e[e.DelKey=5]="DelKey"})(X=F.NearTypes||(F.NearTypes={}));var Oe=class extends T.BaseWallet{async getDerivedPath(r){return`m/44'/397'/${r.index}'`}async getRandomPrivateKey(){try{let r=c.signUtil.ed25519.ed25519_getRandomPrivateKey(!1,"hex"),t=c.base.toHex(c.signUtil.ed25519.publicKeyCreate(c.base.fromHex(r)),!1);return Promise.resolve("ed25519:"+c.base.toBase58(c.base.fromHex(r+t)))}catch{return Promise.reject(T.GenPrivateKeyError)}}async getDerivedPrivateKey(r){try{let t=await c.signUtil.ed25519.ed25519_getDerivedPrivateKey(r.mnemonic,r.hdPath,!1,"hex"),s=c.base.toHex(c.signUtil.ed25519.publicKeyCreate(c.base.fromHex(t)));return Promise.resolve("ed25519:"+c.base.toBase58(c.base.fromHex(t+s)))}catch{return Promise.reject(T.GenPrivateKeyError)}}async getNewAddress(r){try{if(!r.privateKey)throw T.NewAddressError;if(r.privateKey.startsWith("0x")||r.privateKey.startsWith("0X")){let n=r.privateKey.substring(2);if(c.base.isHexString("0x"+n))return Promise.resolve({address:(0,f.getAddress)(r.privateKey),publicKey:(0,f.getPubkey)(r.privateKey)})}if(!r.privateKey.startsWith("0x")&&!r.privateKey.startsWith("0X")&&c.base.isHexString("0x"+r.privateKey))return Promise.resolve({address:(0,f.getAddress)(r.privateKey),publicKey:(0,f.getPubkey)(r.privateKey)});let t=r.privateKey.split(":");if(t.length!=2||t[0]!="ed25519")throw T.NewAddressError;let s=c.base.fromBase58(t[1]),a=c.base.toHex(s.slice(0,32)),u=(0,f.getAddress)(a);return Promise.resolve({address:u,publicKey:(0,f.getPubkey)(a)})}catch{return Promise.reject(T.NewAddressError)}}async validPrivateKey(r){let t=r.privateKey.startsWith("0x")?r.privateKey:"0x"+r.privateKey,s;if(c.base.isHexString(t))try{s=(0,f.checkPrivateKey)(r.privateKey)}catch{s=!1}else{let u=r.privateKey.split(":");if(u.length!=2||u[0]!="ed25519")s=!1;else{let n=c.base.fromBase58(u[1]),l=c.base.toHex(n.slice(0,32));try{s=(0,f.checkPrivateKey)(l)}catch{s=!1}}}let a={isValid:s,privateKey:r.privateKey};return Promise.resolve(a)}getBase58Address(r){let t=r.split(":");if(t.length!=2||t[0]!="ed25519")throw T.NewAddressError;let s=c.base.fromBase58(t[1]),a=c.base.toHex(s.slice(0,32));return(0,f.getAddress)(a)}getPrvFromBase58(r){let t=r.split(":");if(t.length!=2||t[0]!="ed25519")throw T.NewAddressError;let s=c.base.fromBase58(t[1]);return c.base.toHex(s)}getBase58Pubkey(r){let t=r.split(":");if(t.length!=2||t[0]!="ed25519")throw T.NewAddressError;let s=c.base.fromBase58(t[1]),a=c.base.toHex(s.slice(0,32));return(0,f.publicKeyFromSeed)(a)}async signCommonMsg(r){let t=r.privateKey.startsWith("0x")||r.privateKey.startsWith("0X")?r.privateKey.substring(2):r.privateKey;if(!r.privateKey.startsWith("0x")&&!r.privateKey.startsWith("0X")&&!c.base.isHexString("0x"+r.privateKey)){let s=r.privateKey.split(":");if(s.length!=2||s[0]!="ed25519")throw Error("invalid privateKey");let a=c.base.fromBase58(s[1]);t=c.base.toHex(a.slice(0,32))}return super.signCommonMsg({privateKey:r.privateKey,privateKeyHex:t,message:r.message,signType:T.SignType.ED25519})}async signMessage(r){try{let t=r.data,{message:s,nonce:a,recipient:u,callbackUrl:n,state:l}=t,h=m.Buffer.from(a);if(h.length!==32)throw Error("Expected nonce to be a 32 bytes buffer");let K=new xr.MessagePayload({message:s,nonce:h,recipient:u,callbackUrl:n}),O=(0,kr.serialize)(f.SCHEMA,K),fe=c.base.sha256(O),ce=this.getPrvFromBase58(r.privateKey),j=c.base.fromHex(ce),Je=c.signUtil.ed25519.sign(fe,j);return Promise.resolve(m.Buffer.from(Je).toString("base64"))}catch{return Promise.reject(T.SignMsgError)}}async signTransaction(r){try{let t=r.data.type||0,s=this.getBase58Address(r.privateKey),a=this.getBase58Pubkey(r.privateKey),u=this.getPrvFromBase58(r.privateKey);if(t===X.TransferNear){let n=r.data,l=(0,f.createTransaction)(n.from==null||null||n.from==""?s:n.from,a,n.receiverId,n.nonce,[],c.base.fromBase58(n.blockHash));l.actions.push((0,f.transfer)(new c.BN(n.amount)));let[h,K]=await(0,f.signTransaction)(l,u);return Promise.resolve(c.base.toBase64(K.encode()))}else if(t===X.AddKey){let n=r.data;if(n.publicKey==null||null||n.accessKey==null)return Promise.reject(T.SignTxError);let l=(0,f.createTransaction)(n.from==null||null||n.from==""?s:n.from,a,n.receiverId,n.nonce,[],c.base.fromBase58(n.blockHash));l.actions.push((0,f.addKey)((0,f.publicKeyFromBase58)(n.publicKey),n.accessKey));let[h,K]=await(0,f.signTransaction)(l,u);return Promise.resolve(c.base.toBase64(K.encode()))}else if(t===X.DelKey){let n=r.data;if(n.publicKey==null)return Promise.reject(T.SignTxError);let l=(0,f.createTransaction)(n.from==null||null||n.from==""?s:n.from,a,n.receiverId,n.nonce,[],c.base.fromBase58(n.blockHash));l.actions.push((0,f.deleteKey)((0,f.publicKeyFromBase58)(n.publicKey)));let[h,K]=await(0,f.signTransaction)(l,u);return Promise.resolve(c.base.toBase64(K.encode()))}else if(t===X.TransferToken){let n=r.data,l=(0,f.createTransaction)(n.from==null||null||n.from==""?s:n.from,a,n.contract,n.nonce,[],c.base.fromBase58(n.blockHash));if(n.shouldDeposit){let ce={account_id:n.receiverId},j=(0,f.functionCall)("storage_deposit",ce,new c.BN(n.depositGas),new c.BN(n.depositValue));l.actions.push(j)}let h={amount:n.amount,receiver_id:n.receiverId},K=(0,f.functionCall)("ft_transfer",h,new c.BN(n.transferGas),new c.BN(n.minTransferTokenValue));l.actions.push(K);let[O,fe]=await(0,f.signTransaction)(l,u);return Promise.resolve(c.base.toBase64(fe.encode()))}else if(t===X.DAppTx){let n=r.data;if(n.actions==null||n.actions==null||n.actions.length==0)return Promise.reject(T.SignTxError);let l=n.actions.map(O=>(0,f.functionCall)(O.methodName,O.args,new c.BN(O.gas),new c.BN(O.deposit))),[h,K]=await(0,f.signTransaction)(n.receiverId,n.nonce,l,c.base.fromBase58(n.blockHash),u,n.from==null||null||n.from==""?s:n.from);return Promise.resolve(c.base.toBase64(K.encode()))}else if(t===X.DAppTxs){let n=r.data;if(n.transactions==null||n.transactions==null||n.transactions.length==0)return Promise.reject(T.SignTxError);let l=[];for(let h=0;h<n.transactions.length;h++){let K=n.transactions[h],O=K.actions.map(j=>(0,f.functionCall)(j.methodName,j.args,new c.BN(j.gas),new c.BN(j.deposit))),[fe,ce]=await(0,f.signTransaction)(K.receiverId,new c.BN(n.nonce).add(new c.BN(h)).toNumber(),O,c.base.fromBase58(n.blockHash),u,n.from==null||null||n.from==""?s:n.from);l.push(c.base.toBase64(ce.encode()))}return Promise.resolve(l)}else return Promise.reject(T.SignTxError)}catch{return Promise.reject(T.SignTxError)}}async validAddress(r){let t=!1;try{t=(0,f.validateAddress)(r.address)}catch{}let s={isValid:t,address:r.address};return Promise.resolve(s)}async calcTxHash(r){try{let t=f.SignedTransaction.decode(m.Buffer.from(c.base.fromBase64(r.data))),s=c.base.toBase58(c.base.sha256(t.transaction.encode()));return Promise.resolve(s)}catch{throw T.CalcTxHashError}}};F.NearWallet=Oe});var Xe=w(v=>{g();p();var Br=v&&v.__createBinding||(Object.create?function(e,r,t,s){s===void 0&&(s=t);var a=Object.getOwnPropertyDescriptor(r,t);(!a||("get"in a?!r.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return r[t]}}),Object.defineProperty(e,s,a)}:function(e,r,t,s){s===void 0&&(s=t),e[s]=r[t]}),Fe=v&&v.__exportStar||function(e,r){for(var t in e)t!=="default"&&!Object.prototype.hasOwnProperty.call(r,t)&&Br(r,e,t)};Object.defineProperty(v,"__esModule",{value:!0});v.publicKeyFromBase58=v.publicKeyFromSeed=v.checkName=v.validateAddress=v.getPubkey=v.checkPrivateKey=v.getAddress=void 0;var Ve=Te(),k=V(),Mr=ke();Fe(ze(),v);Fe(Le(),v);function Or(e){if(!Ne(e))throw new Error("invalid key");let t=e;(e.startsWith("0x")||e.startsWith("0X"))&&(t=e.substring(2));let s=k.signUtil.ed25519.publicKeyCreate(k.base.fromHex(t));return k.base.toHex(s)}v.getAddress=Or;function Ne(e){if(!e)throw new Error("invalid key");let r="";if(e.startsWith("0x")||e.startsWith("0X")){if(r=e.substring(2),!k.base.isHexString("0x"+r))throw new Error("invalid key");if(e.length!=130&&e.length!=66)throw new Error("invalid key")}else{if(!k.base.isHexString("0x"+e))throw new Error("invalid key");if(e.length!=128&&e.length!=64)throw new Error("invalid key");r=e}let t=k.base.fromHex(r);if(t.length!=64&&t.length!=32||t.every(s=>s===0))throw new Error("invalid key");return!0}v.checkPrivateKey=Ne;function Nr(e){Ne(e);let r=k.signUtil.ed25519.publicKeyCreate(k.base.fromHex(e));return"ed25519:"+k.base.toBase58(r)}v.getPubkey=Nr;function Hr(e){return e.length>=2&&e.length<=64&&$e(e)}v.validateAddress=Hr;function $e(e){return new RegExp("^(([a-z\\d]+[\\-_])*[a-z\\d]+\\.)*([a-z\\d]+[\\-_])*[a-z\\d]+$").test(e)}v.checkName=$e;function jr(e){let r=k.signUtil.ed25519.publicKeyCreate(k.base.fromHex(e));return Ve.PublicKey.fromRaw(r)}v.publicKeyFromSeed=jr;function Ir(e){let r=e.split(":");if(r.length!=2||r[0]!="ed25519")throw Mr.SignTxError;return Ve.PublicKey.fromRaw(k.base.fromBase58(r[1]))}v.publicKeyFromBase58=Ir});export{Xe as a};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-ZCI4FWQR.js.map
