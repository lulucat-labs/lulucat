import{a as Ye}from"./chunk-ZB2SWNJ5.js";import"./chunk-X2HEJ6XO.js";import{a as He}from"./chunk-OL23QTWJ.js";import{a as oe}from"./chunk-WVLQP46O.js";import{a as te}from"./chunk-2P7I7CKT.js";import{a as Me,b as je}from"./chunk-2LFRM3KT.js";import"./chunk-GGZ73X5S.js";import"./chunk-IEUJSLGG.js";import"./chunk-QIV5EJPL.js";import"./chunk-KYU5M654.js";import"./chunk-YSEHOL75.js";import"./chunk-MNWYB2XY.js";import"./chunk-AOBCHKFQ.js";import"./chunk-DEQWBIFF.js";import"./chunk-ELJOB4BQ.js";import"./chunk-ELHNWADN.js";import"./chunk-GCAD5G3O.js";import"./chunk-PS6ETN2V.js";import"./chunk-AZYPLE5D.js";import"./chunk-SULFXTUN.js";import"./chunk-OGS4HURJ.js";import"./chunk-T6GLUO36.js";import{a as Ue}from"./chunk-GRXKA7HE.js";import"./chunk-SNFTVDFG.js";import"./chunk-HZNY4MK4.js";import"./chunk-6CI55CTV.js";import"./chunk-ZZLPMRQY.js";import"./chunk-4HGOSSS7.js";import"./chunk-OIXVONQI.js";import"./chunk-REMRMZNH.js";import"./chunk-74FNJDB7.js";import{a as ze}from"./chunk-GOMM7VSE.js";import"./chunk-MSUJSPID.js";import"./chunk-TU5XNYNZ.js";import{a as Re}from"./chunk-MZFOYMI4.js";import"./chunk-EQ275TZX.js";import{G as Le,a as Pe,k as De,l as Ae}from"./chunk-WSXZYUQ4.js";import"./chunk-JRZXGORL.js";import{q as G}from"./chunk-IRNZUYU4.js";import"./chunk-SFTZ55EP.js";import"./chunk-DZHQUYHS.js";import{o as Be}from"./chunk-AUURQ3HI.js";import{r as F}from"./chunk-B32MCU7F.js";import"./chunk-VOLYN562.js";import{a as ue}from"./chunk-VLKJDIZ5.js";import"./chunk-N4B7HQY5.js";import"./chunk-TKFT6XV3.js";import"./chunk-MBLN6WQR.js";import{l as Oe}from"./chunk-OWU5GWTN.js";import"./chunk-2BGRD7AD.js";import"./chunk-TCJNKUJ2.js";import"./chunk-2UKLMOTV.js";import"./chunk-ZWQEMYA4.js";import"./chunk-ELX2GHLL.js";import{c as E}from"./chunk-AIPMH74P.js";import"./chunk-DJDG7W5Q.js";import{Aa as be,Ka as O,Ma as Te,Pa as we,Qa as ve,Y as X,_a as Z,tb as Ee,ya as xe,yb as ft}from"./chunk-Q23SA7M6.js";import"./chunk-XXICVAVV.js";import{H as ee,d as ce,g as q,o as Fe,q as g,w as me}from"./chunk-E44TZGUB.js";import{F as ke,oa as pt}from"./chunk-KBQXBPIW.js";import{B as z,O as N,w as i}from"./chunk-364XNTHB.js";import"./chunk-NBWNTERD.js";import"./chunk-GBTEQNFM.js";import"./chunk-QBHNZ2BL.js";import"./chunk-J6E3F25X.js";import{H as gt,T as Se,Z as Ne,ca as b}from"./chunk-W7JONHX2.js";import"./chunk-O3LHCDGR.js";import{a as v}from"./chunk-PDSGFBX4.js";import"./chunk-GAMT4PKF.js";import"./chunk-R4QAJG6J.js";import"./chunk-LI7MZD2P.js";import"./chunk-WTNDHHRR.js";import"./chunk-CGP26AOO.js";import"./chunk-ZSUO3ILU.js";import"./chunk-ATMUHCXK.js";import"./chunk-3MCJH4Z7.js";import"./chunk-AGN4QMRN.js";import"./chunk-FV56V3FL.js";import"./chunk-7MZSFBF4.js";import"./chunk-3SRT54EN.js";import"./chunk-J5P7OMUC.js";import"./chunk-3CPUV3E7.js";import"./chunk-SHMKQUVK.js";import{f as d,o as r,q as n}from"./chunk-FJHLV356.js";r();n();var s=d(v()),nt=d(ue());N();r();n();var B=d(v()),re=d(ue());N();var Ze=d(gt());var yt=(e,t)=>{let o=e==="protocol"?Ae:De;if(t){let a=new URLSearchParams(t).toString();return`${o}?${a}`}return o},Ct=({selectedInfo:e,category:t})=>{let o=(0,re.useHistory)(),a=(0,re.useLocation)(),l=new URLSearchParams(a.search);return B.default.createElement("div",{className:"chain-select",onClick:()=>{let c={...Object.fromEntries(l.entries()),pageType:"customCrypto"};o.push(yt(t,c))}},B.default.createElement("div",{className:"chain-select-title"},t==="protocol"?i("extension_defi_info_title_protocol"):i("wallet_custom_crypto_subtitle_select_network")),B.default.createElement("div",{className:"chain-select-box"},t==="protocol"?null:B.default.createElement("img",{className:"chain-select-icon",src:e?.imageUrl||e?.logo,alt:"chain"}),B.default.createElement("div",{className:"chain-select-name"},e?.name),B.default.createElement(Se,{className:(0,Ze.default)("okds-arrow-chevron-right-centered-md","chain-select-arrow")})))},ne=Ct;r();n();var de=d(v());var ht=({currentAddress:e,addressInputTitle:t,errorText:o,placeHolderText:a,addressIsInvalid:l,updateCustomCoin:c})=>de.default.createElement("div",{className:"contract-address-box"},de.default.createElement(g.TextArea,{autoResize:!0,value:e,title:t,size:g.SIZE.xl,error:l&&o,errorType:g.TIP_TYPE.always,placeholder:a,onChange:p=>{c(p.target.value)}})),qe=ht;r();n();var C=d(v());N();r();n();var M={"risk-dialog-footer":"_risk-dialog-footer_1jyn7_1",riskDialogFooter:"_risk-dialog-footer_1jyn7_1","risk-dialog-content":"_risk-dialog-content_1jyn7_4",riskDialogContent:"_risk-dialog-content_1jyn7_4","risk-dialog-confirm-btn":"_risk-dialog-confirm-btn_1jyn7_7",riskDialogConfirmBtn:"_risk-dialog-confirm-btn_1jyn7_7","risk-dialog-title":"_risk-dialog-title_1jyn7_16",riskDialogTitle:"_risk-dialog-title_1jyn7_16","risk-dialog-desc":"_risk-dialog-desc_1jyn7_22",riskDialogDesc:"_risk-dialog-desc_1jyn7_22","risk-dialog-jump-link":"_risk-dialog-jump-link_1jyn7_25",riskDialogJumpLink:"_risk-dialog-jump-link_1jyn7_25"};var It=({onCloseDialog:e,onNext:t,riskJumpUrl:o})=>{let a=Ue(),l=(0,C.useCallback)(()=>{o&&setTimeout(()=>{globalThis.platform.openTab({url:`${a.origin}${o}`})},100)},[o]);return C.default.createElement(Fe,{visible:!0,title:!1,footer:C.default.createElement(E.FlexBox,{className:M.riskDialogFooter,direction:E.DIRECTION.vertical,align:E.ALIGN.center},C.default.createElement(b,{category:b.CATEGORY.outline,type:b.TYPE.primary,size:b.SIZE.lg,block:!0,onClick:e},z("commonall_text_btn_cancel")),C.default.createElement("span",{className:M.riskDialogConfirmBtn,onClick:t},z("wallet_extension_risk_alert_btn_continue_add"))),noMargin:!0,isFull:!0,hideCloseBtn:!0},C.default.createElement(E.FlexBox,{direction:E.DIRECTION.vertical,align:E.ALIGN.center,justify:"center",className:M.riskDialogContent},C.default.createElement(ce,{width:100,height:100,src:"/static/images/risk-warning.png",layout:ce.LAYOUT.contain}),C.default.createElement(G.Text,{strong:500,className:M.riskDialogTitle},z("wallet_extension_risk_alert_title_approve_eoa")),C.default.createElement(G.Text,{size:G.SIZE.sm,type:G.TYPE.secondary,strong:400,className:M.riskDialogDesc},z("wallet_extension_risk_alert_desc_approve_eoa",{detail:""})),o&&C.default.createElement(q,{type:q.TYPE.primary,underline:!0,weight:q.WEIGHT.muted,size:q.SIZE.md,onClick:l,className:M.riskDialogJumpLink},z("wallet_extension_risk_alert_icu_approve_eoa"))))},Ge=It;r();n();ft();Z();var _e={[O]:{title:"wallet_extension_create_input_title_contract_token_symbol",error:"developer_mode_manage_errortip_request_failed",placeholder:"extension_token_input_addcustom_crypto"},[Ee]:{title:"extension_wallet_customcoin_text_currency_symbol",error:"extension_wallet_customcoin_errortip_crypto_notfound",placeholderName:"extension_defi_placeholder_enter_token_name",placeholderId:"extension_defi_placeholder_enter_token_id",placeholder:"extension_defi_placeholder_enter_token_id_name"},[be]:{title:"extension_wallet_customcoin_text_currency_symbol",titleId:"wallet_extension_cat_desc_token_id",error:"extension_wallet_customcoin_errortip_crypto_notfound",placeholderName:"extension_defi_placeholder_enter_token_name",placeholderId:"extension_defi_placeholder_enter_token_id",placeholder:"extension_defi_placeholder_enter_token_id_name"},[Te]:{title:"extension_wallet_cardano_text_fingerprint",error:"developer_mode_manage_errortip_request_failed",placeholder:"extension_token_input_addcustom_crypto"},[we]:{title:"wallet_extension_import_title_jetton_master",error:"developer_mode_manage_errortip_request_failed",placeholder:"wallet_extension_import_input_jetton_master"},[ve]:{title:"wallet_extension_selecttoken_input_label_asset_issuer",placeholder:"wallet_extension_selecttoken_input_placeholder_issuer_name",symbolTitle:"wallet_extension_selecttoken_input_label_asset_code",symbolPlaceholder:"wallet_extension_selecttoken_input_placeholder_asset_code",error:"developer_mode_manage_errortip_request_failed"},default:{title:"wallet_transaction_history_subtitle_contract_address",error:"developer_mode_manage_errortip_request_failed",placeholder:"extension_token_input_addcustom_crypto"}};r();n();var R=d(v());N();Z();r();n();var j=d(v());N();var kt=({isFacet:e,onToggle:t})=>{let o=[{value:"ERC20",label:"ERC20"},{value:"Facet",label:"Facet"}],[a,l]=(0,j.useState)(e?"Facet":"ERC20"),c=(0,j.useCallback)((p={value:"ERC20"})=>{l(p.value),t(p.value==="Facet")},[]);return j.default.createElement("div",{className:"chain-select-isfacet"},j.default.createElement(me,{title:i("extension_defi_info_title_protocol"),value:a,options:o,onChange:c,size:me.SIZE.lg,searchable:!1,dropMode:!0}))},Ve=kt;var xt=({selectedNetwork:e,account:t,accountIsInvalid:o,accountErrorMessage:a,setAccount:l,updateCustomCoin:c,accountRef:p,setProtocol:h,protocol:k,protocolList:f,isFacet:x,setIsFacet:y})=>{let U=te(),u=Number(U.get("protocolId"));return(0,R.useEffect)(()=>{let m=null;if(!F(e)){h("");return}if(u&&f?.length&&(m=f.find(w=>w.protocolId===u)),!m&&f.length>0&&(m=f[0]),m){let w={...m,name:m.protocolName};h(w)}},[f,e]),{renderCustomForm:()=>e?.coinId===O?R.default.createElement("div",{className:"contract-address-box"},R.default.createElement(g.TextArea,{autoResize:!0,value:t,title:i("wallet_extension_create_input_title_contract_account_name"),size:g.SIZE.xl,error:o&&a,errorType:g.TIP_TYPE.always,placeholder:i("wallet_extension_create_input_title_contract_token_symbol"),onChange:m=>{l(m.target.value),p.current=m.target.value,c()}})):e?.coinId===xe?R.default.createElement(Ve,{isFacet:x,onToggle:m=>{y(m),c()}}):F(e)&&k?R.default.createElement(ne,{selectedInfo:k,category:"protocol"}):null}},We=xt;r();n();var P=d(v()),$e=d(Be());pt();Z();var bt=({selectedNetwork:e,currentAddress:t,isFacet:o,currentAddressRef:a,currentSymbolRef:l,accountRef:c,protocol:p})=>{let[h,k]=(0,P.useState)({}),[f,x]=(0,P.useState)(!1),[y,U]=(0,P.useState)(""),[u,T]=(0,P.useState)(!0),[m,w]=(0,P.useState)(""),[D,A]=(0,P.useState)(!1),[ge,V]=(0,P.useState)(!1),H=I=>`facet_${I}`,{run:W}=(0,$e.useDebounceFn)(async({addr:I,accountName:$,protocolId:K,symbol:Q})=>{if(V(!1),!I)return;let J=oe(e.coinId);if(J&&ke(Q))return;let S;try{S=await Me({contractAddress:o?H(I):I,chainInfo:e,account:$,isFacet:o,...F(e)?{protocolId:K}:{},...J?{symbol:Q}:{}})}catch(ae){S={},ae?.data?.originalError?.data?.code==="ERR_NETWORK"&&V(!0)}if(I===t){if(k(S),e.coinId===O&&!S?.accountValid){x(!0),U(S.msg),T(!0);return}else if(!m&&e?.coinId===O){A(!1),T(!0);return}x(!1),U(""),I&&S?.symbol?(A(!1),T(!1)):I?(A(!0),T(!0)):(A(!1),T(!0))}},{wait:500});return{customCoin:h,accountIsInvalid:f,accountErrorMessage:y,stateOnLock:u,account:m,addressIsInvalid:D,setAccount:w,updateCustomCoin:()=>{k({}),T(!0),W({addr:a.current,accountName:c.current,protocolId:p?.protocolId,symbol:l.current})},networkError:ge}},Ke=bt;r();n();var Qe=d(ue()),ie=d(Be());N();r();n();function Tt(e,t){if(e.key&&t.key)return e.key===t.key;if(e.coinId&&t.coinId)return e.coinId===t.coinId;let o=e.address||e.contractAddress,a=t.address||t.contractAddress;return o&&a?o.toLowerCase()===a.toLowerCase()&&e.localType===t.localType:!1}function pe(e,t){for(let o=0;o<t.length;o++){let a=t[o];if(Tt(a,e)||a.childrenCoin&&pe(e,a.childrenCoin))return!0}return!1}function fe(e,t){let o=(0,Qe.useHistory)(),[a,{setTrue:l,setFalse:c}]=(0,ie.useBoolean)(),p=He(),{run:h}=(0,ie.useDebounceFn)(async()=>{if(l(),pe(e,p)){ee.error(i("wallet_manage_crypto_errortip_crypto_added")),c();return}try{await je({...e,protocolId:t}),ee.success(i("wallet_manage_crypto_toast_custom_crypto_success")),o.push(Pe)}catch(f){let x=f?.data?.originalError?.msg||i("wallet_extenshion_toast_add_failed");ee.error(x)}finally{c()}},{wait:100});return{isSubmitting:a,submitAction:h}}r();n();r();n();var Xe=d(v());N();Z();r();n();var Je={root:"_root_11n0d_1"};var wt=(e,t,o)=>oe(t.coinId)?{show:!0,value:o,disabled:!1}:e?.localType===X?{show:!1,value:e?.symbol,disabled:!0}:{show:e?.symbol!==void 0,value:e?.symbol,disabled:!0},vt=({customCoin:e={},selectedNetwork:t,onChange:o,value:a,title:l,placeholder:c})=>{let p=x=>{o?.(x.target.value)},{show:h,value:k,disabled:f}=wt(e,t,a);return h&&Xe.default.createElement(g,{className:Je.root,label:l||i("wallet_manage_crypto_subtitle_custom_crpto_symbol"),placeholder:c,disabled:f,value:k,size:g.SIZE.xl,onChange:p})},et=vt;r();n();var ot=d(v());N();Z();r();n();var tt={root:"_root_11n0d_1"};var Et=({customCoin:e}={})=>e?.decimals===void 0||e?.localType===X?null:ot.default.createElement(g,{className:tt.root,label:i("wallet_manage_crypto_custom_coin_subtitle_decimals"),disabled:!0,value:e.decimals,size:g.SIZE.xl}),rt=Et;var St="Ethereum",Nt=()=>{let e=(0,nt.useHistory)(),t=s.default.useRef(""),o=s.default.useRef(""),a=s.default.useRef(""),l=s.default.useRef(""),[c,p]=(0,s.useState)(!1),[h,k]=(0,s.useState)(""),[f,x]=(0,s.useState)(""),[y,U]=(0,s.useState)(""),[u,T]=(0,s.useState)({imageUrl:"",name:"",coinId:-1}),[m,w]=(0,s.useState)(!1),{data:{supportNetworkList:D,protocolList:A}={}}=Ye(u.coinId),V=te().get("network"),{title:H,titleId:W,error:se,placeholder:I,placeholderName:$,placeholderId:K,symbolTitle:Q,symbolPlaceholder:J}=_e[u?.coinId]||_e.default,S=(0,s.useMemo)(()=>F(u)&&y?.searchType?y.searchType===1?i(H):i(W):i(H),[y.searchType,u,H,W]),ae=(0,s.useMemo)(()=>F(u)&&y?.searchType?y.searchType===1?i($):i(K):i(I),[I,K,$,y.searchType,u?.coinId]),{customCoin:Y,accountIsInvalid:ye,accountErrorMessage:it,stateOnLock:st,account:at,addressIsInvalid:Ce,setAccount:lt,updateCustomCoin:le,networkError:he}=Ke({selectedNetwork:u,currentAddress:h,currentSymbol:f,isFacet:c,currentAddressRef:a,currentSymbolRef:l,accountRef:t,protocol:y}),ct=(0,s.useMemo)(()=>he?i("developer_mode_manage_errortip_network_error"):i(se),[se,he]),{renderCustomForm:mt}=We({selectedNetwork:u,account:at,accountIsInvalid:ye,accountErrorMessage:it,setAccount:lt,updateCustomCoin:le,accountRef:t,protocolRef:o,setProtocol:U,protocol:y,protocolList:A,isFacet:c,setIsFacet:p}),{isSubmitting:ut,submitAction:Ie}=fe(Y,y.protocolId);return(0,s.useEffect)(()=>{async function L(){if(D.length>0){let dt=V||St;T(D.filter(_t=>_t.name===dt)[0]||D[0])}}L()},[D]),s.default.createElement("div",{className:"custom-crypto-page main-container"},s.default.createElement(ze,{title:i("wallet_manage_crypto_maintitle_custom_crypto"),onBack:()=>{e.push(Le)}}),s.default.createElement(E.Spin,{loading:!D?.length||!A?.length,size:Ne.SIZE.lg},s.default.createElement("div",{className:"custom-crypto--body"},s.default.createElement(ne,{selectedInfo:u}),mt(),s.default.createElement(qe,{updateCustomCoin:L=>{a.current=L,k(L),le()},currentAddress:h,addressInputTitle:S,errorText:ct,placeHolderText:ae,addressIsInvalid:Ce}),s.default.createElement(et,{title:i(Q),placeholder:i(J),customCoin:Y,value:f,selectedNetwork:u,onChange:L=>{l.current=L,x(L),le()}}),s.default.createElement(rt,{customCoin:Y})),s.default.createElement(Re.FooterActions,{usePortal:!0},s.default.createElement(b,{onClick:()=>{Y.riskType===Oe.NORMAL?Ie():w(!0)},size:b.SIZE.lg,type:b.TYPE.highlight,category:b.CATEGORY.fill,loading:ut,disabled:Ce||st||ye},i("wallet_set_password_btn_confirm")))),m&&s.default.createElement(Ge,{onCloseDialog:()=>{w(!1)},onNext:()=>{w(!1),Ie()},riskJumpUrl:Y.riskJumpUrl}))},Ur=Nt;export{Ur as default};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=CustomCrypto-Z4RK5XAV.js.map
