import{a as K}from"./chunk-ELJZY4AU.js";import{d as ee}from"./chunk-4L5OPDYI.js";import{c as X}from"./chunk-3OCLT7XJ.js";import{b as j,c as q,d as z}from"./chunk-ICS7QRDT.js";import{l as C}from"./chunk-GCAD5G3O.js";import{a as A}from"./chunk-PS6ETN2V.js";import{b as Q}from"./chunk-OGS4HURJ.js";import{o as J}from"./chunk-AUURQ3HI.js";import{Yb as Z,cc as pe,q as Y}from"./chunk-B32MCU7F.js";import{a as V}from"./chunk-XRF6BZHR.js";import{$b as w,Ib as y,Kb as h,Lb as g,Mb as H,Nb as F,Ob as M,Pb as W,Qb as $,hc as N}from"./chunk-Q23SA7M6.js";import{da as v,fa as _,oa as me}from"./chunk-KBQXBPIW.js";import{O as le,m as U}from"./chunk-364XNTHB.js";import{a as k}from"./chunk-PDSGFBX4.js";import{f as x,o as f,q as d}from"./chunk-FJHLV356.js";f();d();var T={UNAPPROVED:"unapproved",APPROVED:"approved",REJECTED:"rejected",SIGNED:"signed",SUBMITTED:"submitted",FAILED:"failed",DROPPED:"dropped",SUCCEED:"succeed",PENDING:"pending"},p={TRANS_OUT:1,AUTHORIZATION:2,CONTRACT_CALL:3,CANCEL_AUTHORIZATION:4,CONTRACT_DEPLOY:5},Ae={[p.TRANS_OUT]:"wallet_extension_history_list_send",[p.CONTRACT_CALL]:"wallet_extension_history_list_contract_interaction",[p.AUTHORIZATION]:"wallet_extension_history_list_approval",[p.CANCEL_AUTHORIZATION]:"wallet_extension_history_list_revoke_approval",[p.CONTRACT_DEPLOY]:"developer_mode_history_title_contract_eployment"};f();d();var oe=x(k()),R=x(J());N();f();d();N();var re=async(e={})=>e?.baseFeePerGas!==void 0,L=e=>parseInt(e,16);function fe({baseFeePerGas:e,number:r}){return{number:r,baseFeePerGas:e,gasUsedRatio:null,priorityFeesByPercentile:null}}function de({baseFeePerGas:e,number:r,blockIndex:o,gasUsedRatios:s,priorityFeePercentileGroups:n,percentiles:t}){let i=s[o],a=n[o],u=t.reduce((c,m,l)=>{let E=a[l];return{...c,[m]:L(E)}},{});return{number:r,baseFeePerGas:e,gasUsedRatio:i,priorityFeesByPercentile:u}}async function te({web3:e,numberOfBlocks:r,endBlockNumber:o,percentiles:s,includeNextBlock:n}){let t=await e.eth.getFeeHistory(r,o,s),i=L(t.oldestBlock);if(t.baseFeePerGas!==void 0&&t.baseFeePerGas.length>0&&t.gasUsedRatio.length>0&&(t.reward===void 0||t.reward.length>0)){let a=n?t.baseFeePerGas:t.baseFeePerGas.slice(0,r),u=t.gasUsedRatio,c=t.reward??[],m=u.length;return a.map((l,E)=>{let b=L(l),B=h(i,E);return E>=m?fe({baseFeePerGas:b,number:B}):de({baseFeePerGas:b,number:B,blockIndex:E,gasUsedRatios:u,priorityFeePercentileGroups:c,percentiles:s})})}return[]}var I=1024;function Te(e,r){F(e,r)&&(r=e);let o=[];for(let s=g(e,r);F(s,e);s=h(s,I)){let n=g(e,s),t=n<I?n:I,i=h(s,t);o.push({numberOfBlocks:t,endBlockNumber:i})}return o}var ne=async({web3:e,numberOfBlocks:r,endBlock:o="latest",percentiles:s=[],includeNextBlock:n=!1})=>{let t=s.length>0?Array.from(new Set(s)).sort((c,m)=>c-m):[],a=Te(o,r);return(await Promise.all(a.map(({numberOfBlocks:c,endBlockNumber:m},l)=>l===a.length-1?te({web3:e,numberOfBlocks:c,endBlockNumber:m,percentiles:t,includeNextBlock:n}):te({web3:e,numberOfBlocks:c,endBlockNumber:m,percentiles:t,includeNextBlock:!1})))).reduce((c,m)=>[...c,...m],[])};var Pe=e=>e?C(e):{},Ee=["0x144","0x2105"],he=e=>(0,oe.useCallback)(async()=>e?(await Pe(e)).eth.getBlock("latest"):{},[e]),Ze=e=>(0,R.useMemoizedFn)(async({to:r,from:o,value:s,data:n=""},t)=>{let i=!t,a="";return n?z(n)?a=Y(n):a=q(n):i||(a=K(r,s||0)),await(await C(e)).eth.estimateGas({from:o,to:i?r:t,value:i?s:null,data:a||null})},[e]),S=["low","medium","high"],se={low:{percentile:10,base:1.1,priority:.94,minSuggestedMaxPriorityFeePerGas:1e9,estimatedWaitTimes:{minWaitTimeEstimate:15e3,maxWaitTimeEstimate:3e4}},medium:{percentile:20,base:1.2,priority:.97,minSuggestedMaxPriorityFeePerGas:15e8,estimatedWaitTimes:{minWaitTimeEstimate:15e3,maxWaitTimeEstimate:45e3}},high:{percentile:30,base:1.25,priority:.98,minSuggestedMaxPriorityFeePerGas:2e9,estimatedWaitTimes:{minWaitTimeEstimate:15e3,maxWaitTimeEstimate:6e4}}};function xe(e){let r=e.slice().sort((n,t)=>F(g(n,t),0)?-1:1),o=r.length,s=Math.floor((o-1)/2);return r[s]}var _e=(e,r,o)=>{let s=o[e],n=r[r.length-1].baseFeePerGas,t=y(n,s.base),i=r.map(l=>"priorityFeesByPercentile"in l?l?.priorityFeesByPercentile?.[s.percentile]:null).filter(Boolean),a=xe(i),u=y(a,s.priority),c=H([u,s.minSuggestedMaxPriorityFeePerGas]),m=h(t,c);return{baseFeePerGas:w(t,0),maxFeePerGas:w(m,0),maxPriorityFeePerGas:w(c,0)}},ge=(e,r)=>S.reduce((o,s)=>{let n=_e(s,e,r),{maxFeePerGas:t}=n;return[...o,{level:s,isSupportEip1559:!0,gasPrice:t,...n}]},[]),Fe=(e,r)=>(0,R.useMemoizedFn)(async o=>{let s=await C(e),n=await ne({web3:s,endBlock:o.number,numberOfBlocks:21,percentiles:[10,20,30]});return ge(n,r)},[e]),Ce={low:{coefficient:1.1,level:"low"},medium:{coefficient:1.35,level:"medium"},high:{coefficient:1.7,level:"high"}},Re=(e,r)=>(0,R.useMemoizedFn)(async()=>{let s=await(await C(e)).eth.getGasPrice();return S.reduce((n,t)=>{let{level:i,coefficient:a}=r[t];return[...n,{level:i,gasPrice:y(s,a)}]},[])},[e]);function ye(e){let{rpcNetworks:r}=ee(),o=r.find(s=>s?.rpcUrl===e);return S.reduce((s,n)=>{let t=o?.gasNormal?.[n]||Ce[n]?.coefficient,i=o?.gas1559?.[n]||se?.[n];return{evmNormalGasPrice:{...s.evmNormalGasPrice,[n]:{level:n,coefficient:t}},evm1559GasPrice:{...s.evm1559GasPrice,[n]:{...se[n],base:i?.base,priority:i?.priority}}}},{})}var Ve=(e,r={})=>{let o=ye(e),s=he(e),n=Re(e,o?.evmNormalGasPrice),t=Fe(e,o?.evm1559GasPrice),i=r?.method;return(0,R.useMemoizedFn)(async a=>{if(e){let u=await s(),c=!X({chainId:a,method:i})&&!Ee.includes(a)&&await re(u),m,l=c?t:n;try{m=await l(u)}catch{m=await n(u)}return m}return[]},[e])};f();d();var P=x(k()),G=x(pe()),ie=x(J());me();le();N();function we(){return(0,G.useSelector)(Z,G.shallowEqual)}function D(e,r){let o=we(),s=Q(),{extensionConfig:n}=A("rpc_info"),t=r||n;return(0,P.useMemo)(()=>Object.values(o).filter(i=>{if(!i.txParams)return!1;let{from:a,chainId:u}=i.txParams;return s===a&&u===t.chainId&&e(i)}),[o,s,t.chainId])}function at(e){return D(r=>r.status===T.FAILED||r.status===T.SUCCEED,e)}function ae(e){let[r,o]=e,s=+r,n=+U.add(1,"d",new Date(o));return t=>$(t,s)&&M(t,n)}function ce(e={},r=null){let{dates:o}=e,s=D(n=>n.status===T.FAILED||n.status===T.SUCCEED||n.status===T.DROPPED,r);return(0,P.useMemo)(()=>{let n=s;if(o){let t=ae(o);n=n.filter(({finishTime:i})=>t(i))}return n.sort((t,i)=>i.finishTime-t.finishTime).map(t=>({...t,isShowPending:!1}))},[s,o])}function ue(e={},r=null){let o=D(n=>n.status===T.PENDING,r),{dates:s}=e;return(0,P.useMemo)(()=>{let n=v(o,[t=>j(t.txParams.nonce)]).map((t,i)=>({...t,isShowPending:i===0}));if(s){let t=ae(s);n=n.filter(({sendTime:i})=>t(i))}return n},[o,s])}function Ge(){let e=ue(),r=ce();return(0,P.useMemo)(()=>[...e,...r],[e,r])}function ct(e){let r=Ge();return(0,P.useMemo)(()=>e?r.find(({id:o})=>e===o):null,[e,r])}function ut({tokenAddress:e}){let r=ue(),o=ce();return(0,P.useMemo)(()=>[...r,...o].filter(({type:s,txParams:n,extraParams:t})=>{if(s===p.TRANS_OUT)return!e&&!t?.tokenAddress||_(e)===_(t?.tokenAddress);if(s===p.AUTHORIZATION||s===p.CANCEL_AUTHORIZATION)return _(e)===_(t?.tokenAddress);if(s===p.CONTRACT_CALL){let{value:i}=n||{};return!e&&W(V(i),0)}return!1}),[r,o,e])}var Ne=(e,r,o)=>{let{protocol:s,host:n,pathname:t,search:i,hash:a}=new URL(e),u=t.endsWith("/")?`${t}${r}/${o}`:`${t}/${r}/${o}`;return new URL(`${s}//${n}${u}${i}${a}`).toString()};function mt(){let{extensionConfig:e}=A("rpc_info");return(0,ie.useMemoizedFn)(r=>e?.explorerUrl?Ne(e?.explorerUrl,"tx",r):null)}export{T as a,p as b,Ae as c,at as d,ce as e,ue as f,Ge as g,ct as h,ut as i,Ne as j,mt as k,Ze as l,Ve as m};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-2AM235ZQ.js.map
